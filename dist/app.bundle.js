/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{"use strict";var t,e,r,n,o={},a={};function i(t){var e=a[t];if(void 0!==e)return e.exports;var r=a[t]={exports:{}};return o[t].call(r.exports,r,r.exports,i),r.exports}i.m=o,e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,i.t=function(r,n){if(1&n&&(r=this(r)),8&n)return r;if("object"==typeof r&&r){if(4&n&&r.__esModule)return r;if(16&n&&"function"==typeof r.then)return r}var o=Object.create(null);i.r(o);var a={};t=t||[null,e({}),e([]),e(e)];for(var c=2&n&&r;"object"==typeof c&&!~t.indexOf(c);c=e(c))Object.getOwnPropertyNames(c).forEach((t=>a[t]=()=>r[t]));return a.default=()=>r,i.d(o,a),o},i.d=(t,e)=>{for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},i.f={},i.e=t=>Promise.all(Object.keys(i.f).reduce(((e,r)=>(i.f[r](t,e),e)),[])),i.u=t=>t+".bundle.js",i.miniCssF=t=>{},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r={},n="app-starter-project-with-webpack:",i.l=(t,e,o,a)=>{if(r[t])r[t].push(e);else{var c,s;if(void 0!==o)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var f=u[l];if(f.getAttribute("src")==t||f.getAttribute("data-webpack")==n+o){c=f;break}}c||(s=!0,(c=document.createElement("script")).charset="utf-8",c.timeout=120,i.nc&&c.setAttribute("nonce",i.nc),c.setAttribute("data-webpack",n+o),c.src=t),r[t]=[e];var p=(e,n)=>{c.onerror=c.onload=null,clearTimeout(h);var o=r[t];if(delete r[t],c.parentNode&&c.parentNode.removeChild(c),o&&o.forEach((t=>t(n))),e)return e(n)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=p.bind(null,c.onerror),c.onload=p.bind(null,c.onload),s&&document.head.appendChild(c)}},i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;i.g.importScripts&&(t=i.g.location+"");var e=i.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&(!t||!/^http(s?):/.test(t));)t=r[n--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t})(),(()=>{var t={524:0};i.f.j=(e,r)=>{var n=i.o(t,e)?t[e]:void 0;if(0!==n)if(n)r.push(n[2]);else{var o=new Promise(((r,o)=>n=t[e]=[r,o]));r.push(n[2]=o);var a=i.p+i.u(e),c=new Error;i.l(a,(r=>{if(i.o(t,e)&&(0!==(n=t[e])&&(t[e]=void 0),n)){var o=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;c.message="Loading chunk "+e+" failed.\n("+o+": "+a+")",c.name="ChunkLoadError",c.type=o,c.request=a,n[1](c)}}),"chunk-"+e,e)}};var e=(e,r)=>{var n,o,[a,c,s]=r,u=0;if(a.some((e=>0!==t[e]))){for(n in c)i.o(c,n)&&(i.m[n]=c[n]);s&&s(i)}for(e&&e(r);u<a.length;u++)o=a[u],i.o(t,o)&&t[o]&&t[o][0](),t[o]=0},r=self.webpackChunkapp_starter_project_with_webpack=self.webpackChunkapp_starter_project_with_webpack||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})();const c="https://story-api.dicoding.dev/v1";function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function u(){u=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var a=e&&e.prototype instanceof b?e:b,i=Object.create(a.prototype),c=new N(n||[]);return o(i,"_invoke",{value:O(t,r,c)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",g={};function b(){}function w(){}function x(){}var k={};f(k,i,(function(){return this}));var E=Object.getPrototypeOf,L=E&&E(E(A([])));L&&L!==r&&n.call(L,i)&&(k=L);var S=x.prototype=b.prototype=Object.create(k);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function r(o,a,i,c){var u=h(t[o],t,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==s(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(f).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function O(e,r,n){var o=d;return function(a,i){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=P(c,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=h(e,r,n);if("normal"===u.type){if(o=n.done?m:y,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var a=h(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,g;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(s(e)+" is not iterable")}return w.prototype=x,o(S,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},j(_.prototype),f(_.prototype,c,(function(){return this})),e.AsyncIterator=_,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new _(p(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},j(S),f(S,l,"Generator"),f(S,i,(function(){return this})),f(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function l(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function f(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){l(a,n,o,i,c,"next",t)}function c(t){l(a,n,o,i,c,"throw",t)}i(void 0)}))}}var p={STORIES:"".concat(c,"/stories"),ADD_STORY:"".concat(c,"/stories")};function h(t){return d.apply(this,arguments)}function d(){return(d=f(u().mark((function t(e){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(p.STORIES,{headers:{Authorization:"Bearer ".concat(e)}});case 2:return r=t.sent,t.next=5,r.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function y(t,e){return v.apply(this,arguments)}function v(){return(v=f(u().mark((function t(e,r){var n,o;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(p.ADD_STORY,{method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:e});case 3:return n=t.sent,console.log("Response status:",n.status),t.prev=5,t.next=8,n.json();case 8:o=t.sent,t.next=15;break;case 11:t.prev=11,t.t0=t.catch(5),console.error("Failed to parse JSON:",t.t0),o={error:!0,message:"Invalid response from server"};case 15:return n.ok||(o.error=!0,console.error("API Error Response:",o)),t.abrupt("return",o);case 19:return t.prev=19,t.t1=t.catch(0),console.error("Fetch error:",t.t1),t.abrupt("return",{error:!0,message:t.t1.message});case 23:case"end":return t.stop()}}),t,null,[[0,19],[5,11]])})))).apply(this,arguments)}function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function g(){g=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof b?e:b,i=Object.create(a.prototype),c=new N(n||[]);return o(i,"_invoke",{value:O(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function b(){}function w(){}function x(){}var k={};u(k,i,(function(){return this}));var E=Object.getPrototypeOf,L=E&&E(E(A([])));L&&L!==r&&n.call(L,i)&&(k=L);var S=x.prototype=b.prototype=Object.create(k);function j(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function r(o,a,i,c){var s=f(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==m(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function O(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=P(c,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(m(e)+" is not iterable")}return w.prototype=x,o(S,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=u(x,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,u(t,s,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},j(_.prototype),u(_.prototype,c,(function(){return this})),e.AsyncIterator=_,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new _(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},j(S),u(S,s,"Generator"),u(S,i,(function(){return this})),u(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function b(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function w(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){b(a,n,o,i,c,"next",t)}function c(t){b(a,n,o,i,c,"throw",t)}i(void 0)}))}}var x="stories";function k(){return new Promise((function(t,e){var r=indexedDB.open("StoryMapDB",1);r.onerror=function(){console.error("IndexedDB: Error opening database"),e(r.error)},r.onsuccess=function(){console.log("IndexedDB: Database opened successfully"),t(r.result)},r.onupgradeneeded=function(t){var e=t.target.result;if(!e.objectStoreNames.contains(x)){var r=e.createObjectStore(x,{keyPath:"id",autoIncrement:!1});r.createIndex("name","name",{unique:!1}),r.createIndex("createdAt","createdAt",{unique:!1}),console.log("IndexedDB: Object store created")}}}))}function E(t){return L.apply(this,arguments)}function L(){return(L=w(g().mark((function t(e){var r,n,o,a,i;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,k();case 3:return r=t.sent,n=r.transaction([x],"readwrite"),o=n.objectStore(x),a=e.id||"local-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),i=o.put({id:a,name:e.name,description:e.description,photoUrl:e.photoUrl,lat:e.lat,lon:e.lon,createdAt:e.createdAt||(new Date).toISOString(),syncedAt:(new Date).toISOString()}),t.abrupt("return",new Promise((function(t,e){i.onsuccess=function(){console.log("IndexedDB: Story saved",a),t(i.result)},i.onerror=function(){console.error("IndexedDB: Error saving story",i.error),e(i.error)}})));case 11:throw t.prev=11,t.t0=t.catch(0),console.error("IndexedDB: Failed to save story",t.t0),t.t0;case 15:case"end":return t.stop()}}),t,null,[[0,11]])})))).apply(this,arguments)}function S(){return j.apply(this,arguments)}function j(){return(j=w(g().mark((function t(){var e,r,n,o;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,k();case 3:return e=t.sent,r=e.transaction([x],"readonly"),n=r.objectStore(x),o=n.getAll(),t.abrupt("return",new Promise((function(t,e){o.onsuccess=function(){console.log("IndexedDB: Stories retrieved",o.result.length),t(o.result)},o.onerror=function(){console.error("IndexedDB: Error reading stories",o.error),e(o.error)}})));case 10:throw t.prev=10,t.t0=t.catch(0),console.error("IndexedDB: Failed to read stories",t.t0),t.t0;case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function _(t){return O.apply(this,arguments)}function O(){return(O=w(g().mark((function t(e){var r,n,o,a;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,k();case 3:return r=t.sent,n=r.transaction([x],"readwrite"),o=n.objectStore(x),a=o.delete(e),t.abrupt("return",new Promise((function(t,r){a.onsuccess=function(){console.log("IndexedDB: Story deleted",e),t(!0)},a.onerror=function(){console.error("IndexedDB: Error deleting story",a.error),r(a.error)}})));case 10:throw t.prev=10,t.t0=t.catch(0),console.error("IndexedDB: Failed to delete story",t.t0),t.t0;case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function T(){T=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),c=new N(n||[]);return o(i,"_invoke",{value:j(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(A([])));k&&k!==r&&n.call(k,i)&&(w=k);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,i,c){var s=f(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==P(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function j(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=_(c,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(P(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new S(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),u(E,s,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function I(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function N(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){I(a,n,o,i,c,"next",t)}function c(t){I(a,n,o,i,c,"throw",t)}i(void 0)}))}}function A(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(e),n=new Uint8Array(r.length),o=0;o<r.length;++o)n[o]=r.charCodeAt(o);return n}function B(){return G.apply(this,arguments)}function G(){return(G=N(T().mark((function t(){var e,r;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(c,"/stories/push/vapid-public-key"));case 3:if((e=t.sent).ok){t.next=6;break}throw new Error("Failed to get VAPID public key: ".concat(e.status));case 6:return t.next=8,e.json();case 8:return r=t.sent,t.abrupt("return",r.vapidPublicKey||r.publicKey||r.key);case 12:throw t.prev=12,t.t0=t.catch(0),console.error("Error getting VAPID public key:",t.t0),t.t0;case 16:case"end":return t.stop()}}),t,null,[[0,12]])})))).apply(this,arguments)}function F(){return D.apply(this,arguments)}function D(){return(D=N(T().mark((function t(){var e,r,n,o,a;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("serviceWorker"in navigator&&"PushManager"in window){t.next=3;break}return console.warn("Push notifications are not supported"),t.abrupt("return",null);case 3:return t.prev=3,t.next=6,Notification.requestPermission();case 6:if("granted"===t.sent){t.next=10;break}return console.warn("Notification permission denied"),t.abrupt("return",null);case 10:return t.next=12,navigator.serviceWorker.ready;case 12:return e=t.sent,t.next=15,B();case 15:return r=t.sent,n=A(r),t.next=19,e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:n});case 19:if(o=t.sent,a=localStorage.getItem("authToken")){t.next=24;break}return console.warn("No auth token found"),t.abrupt("return",null);case 24:return t.next=26,fetch("".concat(c,"/stories/push/subscribe"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({subscription:o.toJSON()})});case 26:if(t.sent.ok){t.next=29;break}throw new Error("Failed to subscribe to push notifications");case 29:return localStorage.setItem("pushSubscription",JSON.stringify(o.toJSON())),console.log("Push notification subscribed successfully"),t.abrupt("return",o);case 34:return t.prev=34,t.t0=t.catch(3),console.error("Error subscribing to push notifications:",t.t0),t.abrupt("return",null);case 38:case"end":return t.stop()}}),t,null,[[3,34]])})))).apply(this,arguments)}function C(){return M.apply(this,arguments)}function M(){return(M=N(T().mark((function t(){var e,r;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.serviceWorker.ready;case 3:return e=t.sent,t.next=6,e.pushManager.getSubscription();case 6:if(!(r=t.sent)){t.next=12;break}return t.next=10,r.unsubscribe();case 10:localStorage.removeItem("pushSubscription"),console.log("Push notification unsubscribed successfully");case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),console.error("Error unsubscribing from push notifications:",t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})))).apply(this,arguments)}function q(){return R.apply(this,arguments)}function R(){return(R=N(T().mark((function t(){var e,r;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.serviceWorker.ready;case 3:return e=t.sent,t.next=6,e.pushManager.getSubscription();case 6:return r=t.sent,t.abrupt("return",null!==r);case 10:return t.prev=10,t.t0=t.catch(0),console.error("Error checking subscription:",t.t0),t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function W(){return Y.apply(this,arguments)}function Y(){return(Y=N(T().mark((function t(){return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("serviceWorker"in navigator&&"PushManager"in window){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,q();case 4:if(t.sent){t.next=10;break}if(!localStorage.getItem("authToken")){t.next=10;break}return t.next=10,F();case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function H(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return J(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?J(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function J(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function K(){K=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),c=new T(n||[]);return o(i,"_invoke",{value:j(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(I([])));k&&k!==r&&n.call(k,i)&&(w=k);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,i,c){var s=f(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==U(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function j(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=_(c,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(U(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new S(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),u(E,s,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function z(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function V(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){z(a,n,o,i,c,"next",t)}function c(t){z(a,n,o,i,c,"throw",t)}i(void 0)}))}}function $(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Z(n.key),n)}}function Z(t){var e=function(t){if("object"!=U(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=U(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==U(e)?e:e+""}var Q=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(s=V(K().mark((function t(){return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="home-container">\n        <div class="hero-section">\n          <h1 class="hero-title">üìñ StoryMap</h1>\n          <p class="hero-subtitle">Temukan dan bagikan cerita perjalanan dari berbagai tempat</p>\n        </div>\n\n        <div class="map-controls">\n          <button id="filter-all" class="filter-btn active" aria-pressed="true">Semua</button>\n          <button id="filter-science" class="filter-btn" aria-pressed="false">Sains</button>\n          <button id="filter-history" class="filter-btn" aria-pressed="false">Sejarah</button>\n          <button id="filter-nature" class="filter-btn" aria-pressed="false">Alam</button>\n        </div>\n\n        <div class="content-grid">\n          <div class="map-container">\n            <div id="map" role="application" aria-label="Peta lokasi cerita"></div>\n          </div>\n\n          <div class="stories-sidebar">\n            <div class="stories-header">\n              <h2>Daftar Cerita</h2>\n              <div class="header-actions">\n                <button id="push-notification-btn" class="btn btn-secondary" aria-label="Aktifkan notifikasi push">\n                  üîî Aktifkan Notifikasi\n                </button>\n                <button id="add-story-btn" class="btn btn-primary" aria-label="Tambah cerita baru">\n                  ‚ûï Tambah Cerita\n                </button>\n              </div>\n            </div>\n            <div id="offline-indicator" class="offline-indicator" style="display: none;">\n              <span>üì¥ Mode Offline - Menampilkan data dari IndexedDB</span>\n            </div>\n            <div id="stories-list" class="stories-list" role="list"></div>\n            <div id="stories-loading" class="loading-state" style="display: none;">\n              <p>Memuat cerita...</p>\n            </div>\n          </div>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return s.apply(this,arguments)})},{key:"afterRender",value:(c=V(K().mark((function t(){var e,r,n,o,a,c=this;return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=localStorage.getItem("authToken")){t.next=4;break}return window.location.hash="#/login",t.abrupt("return");case 4:return t.next=6,i.e(481).then(i.t.bind(i,481,23));case 6:return r=t.sent,n=r.map("map").setView([-2.5,118],5),r.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"¬© OpenStreetMap contributors",maxZoom:19}).addTo(n),delete r.Icon.Default.prototype._getIconUrl,r.Icon.Default.mergeOptions({iconRetinaUrl:"images/marker-icon-2x.png",iconUrl:"images/marker-icon.png",shadowUrl:"images/marker-shadow.png"}),this.markers=[],this.allStories=[],this.currentFilter="all",this.map=n,this.L=r,document.getElementById("add-story-btn").addEventListener("click",(function(){window.location.hash="#/add-story"})),o=document.getElementById("push-notification-btn"),this._setupPushNotificationButtonWithRetry(o),(a=document.querySelectorAll(".filter-btn")).forEach((function(t){t.addEventListener("click",(function(){a.forEach((function(t){t.classList.remove("active"),t.setAttribute("aria-pressed","false")})),t.classList.add("active"),t.setAttribute("aria-pressed","true"),c.currentFilter=t.id.replace("filter-",""),c._filterAndDisplayStories(c.allStories,c.currentFilter)}))})),t.next=24,this._loadStories(e);case 24:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"_loadStories",value:(a=V(K().mark((function t(e){var r,n,o,a,i,c,s;return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=document.getElementById("stories-loading"),n=document.getElementById("stories-list"),o=document.getElementById("offline-indicator"),r.style.display="block",n.innerHTML="",o.style.display="none",t.prev=6,t.next=9,h(e);case 9:if((a=t.sent).error||!a.listStory){t.next=39;break}this.allStories=a.listStory,i=H(this.allStories),t.prev=13,i.s();case 15:if((c=i.n()).done){t.next=27;break}return s=c.value,t.prev=17,t.next=20,E(s);case 20:t.next=25;break;case 22:t.prev=22,t.t0=t.catch(17),console.error("Error saving story to IndexedDB:",t.t0);case 25:t.next=15;break;case 27:t.next=32;break;case 29:t.prev=29,t.t1=t.catch(13),i.e(t.t1);case 32:return t.prev=32,i.f(),t.finish(32);case 35:this._filterAndDisplayStories(this.allStories,"all"),o.style.display="none",t.next=41;break;case 39:return t.next=41,this._loadStoriesFromIndexedDB();case 41:t.next=48;break;case 43:return t.prev=43,t.t2=t.catch(6),console.error("Error loading stories from API:",t.t2),t.next=48,this._loadStoriesFromIndexedDB();case 48:return t.prev=48,r.style.display="none",t.finish(48);case 51:case"end":return t.stop()}}),t,this,[[6,43,48,51],[13,29,32,35],[17,22]])}))),function(t){return a.apply(this,arguments)})},{key:"_loadStoriesFromIndexedDB",value:(o=V(K().mark((function t(){var e,r,n;return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=document.getElementById("stories-list"),r=document.getElementById("offline-indicator"),t.prev=2,t.next=5,S();case 5:(n=t.sent)&&n.length>0?(this.allStories=n,this._filterAndDisplayStories(this.allStories,"all"),r.style.display="block"):(e.innerHTML='<p class="empty-state">Tidak ada cerita tersedia. Periksa koneksi internet Anda.</p>',r.style.display="none"),t.next=14;break;case 9:t.prev=9,t.t0=t.catch(2),console.error("Error loading stories from IndexedDB:",t.t0),e.innerHTML='<p class="error-state">Gagal memuat cerita. Silakan coba lagi.</p>',r.style.display="none";case 14:case"end":return t.stop()}}),t,this,[[2,9]])}))),function(){return o.apply(this,arguments)})},{key:"_filterAndDisplayStories",value:function(t,e){var r=this;this.markers.forEach((function(t){return r.map.removeLayer(t)})),this.markers=[];var n=t;"all"!==e&&(n=t.filter((function(t){var r,n;return(null===(r=t.name)||void 0===r?void 0:r.toLowerCase().includes(e))||(null===(n=t.description)||void 0===n?void 0:n.toLowerCase().includes(e))})));var o=document.getElementById("stories-list");if(0===n.length)o.innerHTML='<p class="empty-state">Tidak ada cerita untuk filter ini</p>';else if(o.innerHTML=n.map((function(t){return'\n        <article class="story-card" role="listitem" data-story-id="'.concat(t.id,'">\n          <div class="story-header">\n            <img \n              src="').concat(t.photoUrl,'" \n              alt="').concat(t.name||"Gambar cerita",'"\n              class="story-image"\n              loading="lazy"\n            >\n            <div class="story-title-section">\n              <h3 class="story-title">').concat(t.name||"Untitled",'</h3>\n              <p class="story-author">by ').concat(t.name||"Anonymous",'</p>\n            </div>\n          </div>\n          <p class="story-description">').concat(t.description||"No description available.",'</p>\n          <div class="story-footer">\n            <span class="story-location">üìç ').concat(t.lat,", ").concat(t.lon,'</span>\n            <time class="story-date" datetime="').concat(t.createdAt,'">\n              ').concat(r._formatDate(t.createdAt),'\n            </time>\n          </div>\n          <div class="story-actions">\n            <button \n              class="btn-delete-story" \n              data-story-id="').concat(t.id,'"\n              aria-label="Hapus cerita ').concat(t.name||"ini",'"\n              title="Hapus dari IndexedDB"\n            >\n              üóëÔ∏è Hapus\n            </button>\n          </div>\n        </article>\n      ')})).join(""),document.querySelectorAll(".btn-delete-story").forEach((function(t){t.addEventListener("click",function(){var t=V(K().mark((function t(e){var n,o,a;return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.target.getAttribute("data-story-id"))||!confirm("Apakah Anda yakin ingin menghapus cerita ini dari IndexedDB?")){t.next=20;break}return t.prev=2,t.next=5,_(n);case 5:r.allStories=r.allStories.filter((function(t){return t.id!==n})),r._filterAndDisplayStories(r.allStories,r.currentFilter),o=document.getElementById("stories-list"),(a=document.createElement("div")).className="success-message",a.textContent="Cerita berhasil dihapus dari IndexedDB",a.style.display="block",o.insertBefore(a,o.firstChild),setTimeout((function(){a.remove()}),3e3),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(2),console.error("Error deleting story:",t.t0),alert("Gagal menghapus cerita. Silakan coba lagi.");case 20:case"end":return t.stop()}}),t,null,[[2,16]])})));return function(e){return t.apply(this,arguments)}}())})),n.forEach((function(t){if(t.lat&&t.lon){var e=r.L.marker([t.lat,t.lon]).addTo(r.map).bindPopup('\n              <div class="marker-popup">\n                <h4>'.concat(t.name||"Untitled","</h4>\n                <p>").concat(t.description||"",'</p>\n                <img src="').concat(t.photoUrl,'" alt="').concat(t.name||"",'" style="max-width: 200px; margin-top: 10px;">\n              </div>\n            '));r.markers.push(e)}})),this.markers.length>0){var a=new this.L.featureGroup(this.markers);this.map.fitBounds(a.getBounds().pad(.1))}}},{key:"_formatDate",value:function(t){return new Date(t).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"})}},{key:"_setupPushNotificationButtonWithRetry",value:(n=V(K().mark((function t(e){var r;return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:e.textContent="üîî Memuat...",e.disabled=!0,r=0;case 5:if(!(r<10)){t.next=21;break}return t.next=8,new Promise((function(t){return setTimeout(t,1e3)}));case 8:return t.prev=8,t.next=11,this._setupPushNotificationButton(e);case 11:if(e.disabled&&!e.textContent.includes("Aktifkan")&&!e.textContent.includes("Matikan")){t.next=13;break}return t.abrupt("return");case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(8),console.error("Error setting up push notification button:",t.t0);case 18:r++,t.next=5;break;case 21:"file:"===window.location.protocol&&(e.disabled=!0,e.textContent="üîî Perlu HTTP Server",e.title="Aplikasi harus di-serve via http://localhost (npm run serve)");case 22:case"end":return t.stop()}}),t,this,[[8,15]])}))),function(t){return n.apply(this,arguments)})},{key:"_setupPushNotificationButton",value:(r=V(K().mark((function t(e){var r,n,o;return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:if("serviceWorker"in navigator){t.next=7;break}return e.disabled=!0,e.textContent="üîî Notifikasi Tidak Didukung",e.title="Browser Anda tidak mendukung service worker",t.abrupt("return");case 7:if("PushManager"in window){t.next=12;break}return e.disabled=!0,e.textContent="üîî Notifikasi Tidak Didukung",e.title="Browser Anda tidak mendukung push notification",t.abrupt("return");case 12:if("file:"!==window.location.protocol){t.next=17;break}return e.disabled=!0,e.textContent="üîî Perlu HTTP Server",e.title="Aplikasi harus di-serve via http://localhost. Jalankan: npm run serve",t.abrupt("return");case 17:t.prev=17,r=null,n=0,o=10;case 21:if(r||!(n<o)){t.next=36;break}return t.prev=22,t.next=25,navigator.serviceWorker.ready;case 25:return r=t.sent,t.abrupt("break",36);case 29:return t.prev=29,t.t0=t.catch(22),n++,t.next=34,new Promise((function(t){return setTimeout(t,500)}));case 34:t.next=21;break;case 36:if(r){t.next=41;break}return e.disabled=!0,e.textContent="üîî Menunggu Service Worker...",e.title="Service worker sedang dimuat, silakan refresh halaman",t.abrupt("return");case 41:return t.next=43,q();case 43:t.sent?(e.textContent="üîî Matikan Notifikasi",e.classList.remove("btn-secondary"),e.classList.add("btn-success")):(e.textContent="üîî Aktifkan Notifikasi",e.classList.remove("btn-success"),e.classList.add("btn-secondary")),t.next=53;break;case 47:t.prev=47,t.t1=t.catch(17),console.error("Error setting up push notification button:",t.t1),e.disabled=!0,e.textContent="üîî Error Setup",e.title="Terjadi error saat setup: "+t.t1.message;case 53:e.addEventListener("click",V(K().mark((function t(){var r;return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,q();case 2:if(r=t.sent,t.prev=3,!r){t.next=13;break}return t.next=7,C();case 7:e.textContent="üîî Aktifkan Notifikasi",e.classList.remove("btn-success"),e.classList.add("btn-secondary"),alert("Notifikasi push telah dinonaktifkan"),t.next=17;break;case 13:return t.next=15,F();case 15:t.sent?(e.textContent="üîî Matikan Notifikasi",e.classList.remove("btn-secondary"),e.classList.add("btn-success"),alert("Notifikasi push telah diaktifkan!")):alert("Gagal mengaktifkan notifikasi push. Pastikan Anda memberikan izin.");case 17:t.next=23;break;case 19:t.prev=19,t.t0=t.catch(3),console.error("Error toggling push notification:",t.t0),alert("Terjadi kesalahan saat mengatur notifikasi push");case 23:case"end":return t.stop()}}),t,null,[[3,19]])}))));case 54:case"end":return t.stop()}}),t,null,[[17,47],[22,29]])}))),function(t){return r.apply(this,arguments)})}],e&&$(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,a,c,s}();function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function tt(){tt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),c=new T(n||[]);return o(i,"_invoke",{value:j(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(I([])));k&&k!==r&&n.call(k,i)&&(w=k);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,i,c){var s=f(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==X(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function j(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=_(c,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(X(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new S(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),u(E,s,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function et(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function rt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){et(a,n,o,i,c,"next",t)}function c(t){et(a,n,o,i,c,"throw",t)}i(void 0)}))}}function nt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ot(n.key),n)}}function ot(t){var e=function(t){if("object"!=X(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=X(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==X(e)?e:e+""}var at=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(n=rt(tt().mark((function t(){return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="auth-container">\n        <div class="auth-card">\n          <h1 class="auth-title">Masuk ke StoryMap</h1>\n          <p class="auth-subtitle">Selamat datang kembali! Silakan masuk ke akun Anda.</p>\n          \n          <form id="login-form" class="auth-form" aria-label="Form login">\n            <div class="form-group">\n              <label for="login-email" class="form-label">Email</label>\n              <input \n                type="email" \n                id="login-email" \n                name="email" \n                class="form-input" \n                placeholder="nama@email.com"\n                required\n                aria-required="true"\n                aria-describedby="login-email-error"\n              >\n              <span id="login-email-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <div class="form-group">\n              <label for="login-password" class="form-label">Kata Sandi</label>\n              <input \n                type="password" \n                id="login-password" \n                name="password" \n                class="form-input" \n                placeholder="Masukkan kata sandi"\n                required\n                aria-required="true"\n                aria-describedby="login-password-error"\n              >\n              <span id="login-password-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <button type="submit" class="btn btn-primary btn-block">\n              <span class="btn-text">Masuk</span>\n              <span class="btn-loader" style="display: none;">‚è≥</span>\n            </button>\n\n            <div id="login-error" class="error-message" role="alert" aria-live="polite"></div>\n          </form>\n\n          <p class="auth-footer">\n            Belum punya akun? \n            <a href="#/register" class="auth-link">Daftar sekarang</a>\n          </p>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=rt(tt().mark((function t(){var e,r=this;return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(e=document.getElementById("login-form")).addEventListener("submit",function(){var t=rt(tt().mark((function t(n){var o,a,i,c,s,u,l,f,p,h;return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),o=e.querySelector('button[type="submit"]'),a=o.querySelector(".btn-text"),i=o.querySelector(".btn-loader"),c=document.getElementById("login-error"),s=document.getElementById("login-email"),u=document.getElementById("login-password"),c.textContent="",s.setAttribute("aria-invalid","false"),u.setAttribute("aria-invalid","false"),a.style.display="none",i.style.display="inline",o.disabled=!0,t.prev=13,l=new FormData(e),f={email:l.get("email"),password:l.get("password")},t.next=18,fetch("https://story-api.dicoding.dev/v1/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)});case 18:return p=t.sent,t.next=21,p.json();case 21:if(h=t.sent,p.ok){t.next=24;break}throw new Error(h.message||"Login gagal");case 24:localStorage.setItem("authToken",h.loginResult.token),localStorage.setItem("userName",h.loginResult.name),localStorage.setItem("userEmail",h.loginResult.email),window.location.hash="#/",r._animateTransition(),t.next=37;break;case 31:t.prev=31,t.t0=t.catch(13),c.textContent=t.t0.message,c.style.display="block",s.setAttribute("aria-invalid","true"),u.setAttribute("aria-invalid","true");case 37:return t.prev=37,a.style.display="inline",i.style.display="none",o.disabled=!1,t.finish(37);case 42:case"end":return t.stop()}}),t,null,[[13,31,37,42]])})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"_animateTransition",value:function(){var t=document.querySelector("#main-content");t.style.opacity="0",t.style.transform="translateY(20px)"}}],e&&nt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function it(t){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},it(t)}function ct(){ct=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),c=new T(n||[]);return o(i,"_invoke",{value:j(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(I([])));k&&k!==r&&n.call(k,i)&&(w=k);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,i,c){var s=f(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==it(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function j(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=_(c,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(it(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new S(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),u(E,s,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function st(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function ut(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){st(a,n,o,i,c,"next",t)}function c(t){st(a,n,o,i,c,"throw",t)}i(void 0)}))}}function lt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ft(n.key),n)}}function ft(t){var e=function(t){if("object"!=it(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=it(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==it(e)?e:e+""}var pt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(n=ut(ct().mark((function t(){return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="auth-container">\n        <div class="auth-card">\n          <h1 class="auth-title">Daftar ke StoryMap</h1>\n          <p class="auth-subtitle">Bergabunglah untuk berbagi cerita perjalanan Anda.</p>\n          \n          <form id="register-form" class="auth-form" aria-label="Form pendaftaran">\n            <div class="form-group">\n              <label for="register-name" class="form-label">Nama</label>\n              <input \n                type="text" \n                id="register-name" \n                name="name" \n                class="form-input" \n                placeholder="Nama lengkap"\n                required\n                aria-required="true"\n                aria-describedby="register-name-error"\n              >\n              <span id="register-name-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <div class="form-group">\n              <label for="register-email" class="form-label">Email</label>\n              <input \n                type="email" \n                id="register-email" \n                name="email" \n                class="form-input" \n                placeholder="nama@email.com"\n                required\n                aria-required="true"\n                aria-describedby="register-email-error"\n              >\n              <span id="register-email-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <div class="form-group">\n              <label for="register-password" class="form-label">Kata Sandi</label>\n              <input \n                type="password" \n                id="register-password" \n                name="password" \n                class="form-input" \n                placeholder="Minimal 8 karakter"\n                required\n                minlength="8"\n                aria-required="true"\n                aria-describedby="register-password-error"\n              >\n              <span id="register-password-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <button type="submit" class="btn btn-primary btn-block">\n              <span class="btn-text">Daftar</span>\n              <span class="btn-loader" style="display: none;">‚è≥</span>\n            </button>\n\n            <div id="register-error" class="error-message" role="alert" aria-live="polite"></div>\n          </form>\n\n          <p class="auth-footer">\n            Sudah punya akun? \n            <a href="#/login" class="auth-link">Masuk sekarang</a>\n          </p>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=ut(ct().mark((function t(){var e;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(e=document.getElementById("register-form")).addEventListener("submit",function(){var t=ut(ct().mark((function t(r){var n,o,a,i,c,s,u,l,f,p,h;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),n=e.querySelector('button[type="submit"]'),o=n.querySelector(".btn-text"),a=n.querySelector(".btn-loader"),i=document.getElementById("register-error"),c=document.getElementById("register-name"),s=document.getElementById("register-email"),u=document.getElementById("register-password"),i.textContent="",c.setAttribute("aria-invalid","false"),s.setAttribute("aria-invalid","false"),u.setAttribute("aria-invalid","false"),!(u.value.length<8)){t.next=17;break}return i.textContent="Kata sandi harus minimal 8 karakter",i.style.display="block",u.setAttribute("aria-invalid","true"),t.abrupt("return");case 17:return o.style.display="none",a.style.display="inline",n.disabled=!0,t.prev=20,l=new FormData(e),f={name:l.get("name"),email:l.get("email"),password:l.get("password")},t.next=25,fetch("https://story-api.dicoding.dev/v1/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)});case 25:return p=t.sent,t.next=28,p.json();case 28:if(h=t.sent,p.ok){t.next=31;break}throw new Error(h.message||"Registrasi gagal");case 31:alert("Registrasi berhasil! Silakan login."),window.location.hash="#/login",t.next=40;break;case 35:t.prev=35,t.t0=t.catch(20),i.textContent=t.t0.message,i.style.display="block",s.setAttribute("aria-invalid","true");case 40:return t.prev=40,o.style.display="inline",a.style.display="none",n.disabled=!1,t.finish(40);case 45:case"end":return t.stop()}}),t,null,[[20,35,40,45]])})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}],e&&lt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function ht(t){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(t)}function dt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],s=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);s=!0);}catch(t){u=!0,o=t}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(t,e)||vt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yt(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=vt(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function vt(t,e){if(t){if("string"==typeof t)return mt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mt(t,e):void 0}}function mt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function gt(){gt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),c=new T(n||[]);return o(i,"_invoke",{value:j(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(I([])));k&&k!==r&&n.call(k,i)&&(w=k);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,i,c){var s=f(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==ht(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function j(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=_(c,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ht(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new S(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),u(E,s,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function bt(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function wt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){bt(a,n,o,i,c,"next",t)}function c(t){bt(a,n,o,i,c,"throw",t)}i(void 0)}))}}function xt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,kt(n.key),n)}}function kt(t){var e=function(t){if("object"!=ht(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ht(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ht(e)?e:e+""}var Et=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(n=wt(gt().mark((function t(){return gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="form-container">\n        <div class="form-card">\n          <h1 class="form-title">‚ûï Tambah Cerita Baru</h1>\n          <p class="form-subtitle">Bagikan pengalaman perjalanan Anda dengan yang lain</p>\n          \n          <form id="add-story-form" class="story-form" aria-label="Form tambah cerita">\n            <div class="form-group">\n              <label for="story-name" class="form-label">Judul Cerita</label>\n              <input \n                type="text" \n                id="story-name" \n                name="name" \n                class="form-input" \n                placeholder="Contoh: Eksplorasi Gunung Bromo"\n                required\n                aria-required="true"\n                aria-describedby="story-name-error story-name-help"\n              >\n              <small id="story-name-help" class="form-help">Berikan judul yang menarik untuk cerita Anda</small>\n              <span id="story-name-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <div class="form-group">\n              <label for="story-description" class="form-label">Deskripsi</label>\n              <textarea \n                id="story-description" \n                name="description" \n                class="form-textarea" \n                rows="5"\n                placeholder="Ceritakan pengalaman Anda di tempat ini..."\n                required\n                aria-required="true"\n                aria-describedby="story-description-error story-description-help"\n              ></textarea>\n              <small id="story-description-help" class="form-help">Minimal 10 karakter</small>\n              <span id="story-description-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <div class="form-group">\n              <label class="form-label">üìç Pilih Lokasi di Peta</label>\n              <div id="story-map" style="height: 350px; width: 100%; border-radius: 8px; margin-top: 10px; border: 2px solid #e5e7eb;"></div>\n              <small class="form-help">Klik pada peta untuk memilih koordinat Latitude dan Longitude</small>\n              <span id="story-map-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <div class="form-group">\n              <label for="story-lat" class="form-label" style="display: none;">Latitude</label>\n              <input \n                type="number" \n                id="story-lat" \n                name="lat" \n                class="form-input" \n                step="any"\n                placeholder="-7.2575"\n                required\n                aria-required="true"\n                aria-describedby="story-lat-error story-lat-help"\n                readonly\n              >\n              <small id="story-lat-help" class="form-help">Koordinat akan terisi otomatis saat klik peta</small>\n              <span id="story-lat-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <div class="form-group">\n              <label for="story-lon" class="form-label" style="display: none;">Longitude</label>\n              <input \n                type="number" \n                id="story-lon" \n                name="lon" \n                class="form-input" \n                step="any"\n                placeholder="112.7521"\n                required\n                aria-required="true"\n                aria-describedby="story-lon-error story-lon-help"\n                readonly\n              >\n              <small id="story-lon-help" class="form-help">Koordinat akan terisi otomatis saat klik peta</small>\n              <span id="story-lon-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <div class="form-group">\n              <label for="story-photo" class="form-label">Foto</label>\n              <input \n                type="file" \n                id="story-photo" \n                name="photo" \n                class="form-file" \n                accept="image/*"\n                required\n                aria-required="true"\n                aria-describedby="story-photo-error story-photo-help"\n              >\n              <small id="story-photo-help" class="form-help">Format: JPG, PNG, atau GIF (max 2MB)</small>\n              <span id="story-photo-error" class="error-message" role="alert" aria-live="polite"></span>\n              <div id="photo-preview" class="photo-preview"></div>\n            </div>\n\n            <div class="form-actions">\n              <a href="#/" class="btn btn-secondary">Batal</a>\n              <button type="submit" class="btn btn-primary">\n                <span class="btn-text">Simpan Cerita</span>\n                <span class="btn-loader" style="display: none;">‚è≥</span>\n              </button>\n            </div>\n\n            <div id="form-error" class="error-message" role="alert" aria-live="polite"></div>\n            <div id="form-success" class="success-message" role="status" aria-live="polite"></div>\n          </form>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=wt(gt().mark((function t(){var e,r,n,o,a,c,s;return gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.getElementById("add-story-form"),r=document.getElementById("story-photo"),n=document.getElementById("photo-preview"),o=localStorage.getItem("authToken")){t.next=7;break}return window.location.hash="#/login",t.abrupt("return");case 7:return t.next=9,i.e(481).then(i.t.bind(i,481,23));case 9:a=t.sent,c=a.default.map("story-map").setView([-7.2575,112.7521],13),a.default.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"¬© OpenStreetMap contributors",maxZoom:19}).addTo(c),delete a.default.Icon.Default.prototype._getIconUrl,a.default.Icon.Default.mergeOptions({iconRetinaUrl:"images/marker-icon-2x.png",iconUrl:"images/marker-icon.png",shadowUrl:"images/marker-shadow.png"}),s=null,c.on("click",(function(t){var e=t.latlng,r=e.lat,n=e.lng,o=document.getElementById("story-lat"),i=document.getElementById("story-lon"),u=document.getElementById("story-map-error");o.value=r.toFixed(4),i.value=n.toFixed(4),u.textContent="",u.style.display="none",o.setAttribute("aria-invalid","false"),i.setAttribute("aria-invalid","false"),s&&c.removeLayer(s),s=a.default.marker([r,n]).addTo(c).bindPopup("Koordinat yang dipilih:<br>Lat: ".concat(r.toFixed(4),", Lon: ").concat(n.toFixed(4))).openPopup()})),r.addEventListener("change",(function(t){var e=t.target.files[0];if(e){if(e.size>2097152)return document.getElementById("story-photo-error").textContent="Ukuran file maksimal 2MB",r.setAttribute("aria-invalid","true"),void(n.innerHTML="");if(!e.type.startsWith("image/"))return document.getElementById("story-photo-error").textContent="File harus berupa gambar",r.setAttribute("aria-invalid","true"),void(n.innerHTML="");document.getElementById("story-photo-error").textContent="",r.setAttribute("aria-invalid","false");var o=new FileReader;o.onload=function(t){n.innerHTML='\n            <img src="'.concat(t.target.result,'" alt="Preview foto" class="preview-image">\n          ')},o.readAsDataURL(e)}})),e.addEventListener("submit",function(){var t=wt(gt().mark((function t(r){var n,a,i,c,s,u,l,f,p,h,d,v,m,g,b,w,x,k,L,S;return gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),n=e.querySelector('button[type="submit"]'),a=n.querySelector(".btn-text"),i=n.querySelector(".btn-loader"),c=document.getElementById("form-error"),s=document.getElementById("form-success"),u=document.getElementById("story-map-error"),c.textContent="",s.textContent="",c.style.display="none",s.style.display="none",l=document.getElementById("story-description"),!((f=l.value.length)<10)){t.next=18;break}return c.textContent="Deskripsi harus minimal 10 karakter",c.style.display="block",l.setAttribute("aria-invalid","true"),t.abrupt("return");case 18:if(!(f>1e3)){t.next=23;break}return c.textContent="Deskripsi maksimal 1000 karakter",c.style.display="block",l.setAttribute("aria-invalid","true"),t.abrupt("return");case 23:if(p=document.getElementById("story-lat"),h=document.getElementById("story-lon"),d=parseFloat(p.value),v=parseFloat(h.value),""!==p.value&&""!==h.value&&!isNaN(d)&&!isNaN(v)){t.next=34;break}return u.textContent="‚ö†Ô∏è Silakan pilih lokasi di peta dengan mengklik pada peta",u.style.display="block",p.setAttribute("aria-invalid","true"),h.setAttribute("aria-invalid","true"),document.getElementById("story-map").scrollIntoView({behavior:"smooth",block:"center"}),t.abrupt("return");case 34:if(!(d<-90||d>90)){t.next=39;break}return c.textContent="Latitude harus antara -90 dan 90",c.style.display="block",p.setAttribute("aria-invalid","true"),t.abrupt("return");case 39:if(!(v<-180||v>180)){t.next=44;break}return c.textContent="Longitude harus antara -180 dan 180",c.style.display="block",h.setAttribute("aria-invalid","true"),t.abrupt("return");case 44:a.style.display="none",i.style.display="inline",n.disabled=!0,t.prev=47,(m=new FormData(e)).delete("name"),m.set("lat",d.toString()),m.set("lon",v.toString()),console.log("FormData contents:"),g=yt(m.entries());try{for(g.s();!(b=g.n()).done;)w=dt(b.value,2),x=w[0],k=w[1],console.log(x,":",k)}catch(t){g.e(t)}finally{g.f()}return t.next=57,y(m,o);case 57:if((L=t.sent).error){t.next=75;break}if(!(S=L.story||L)||!S.id&&!S.name){t.next=70;break}return t.prev=61,t.next=64,E(S);case 64:console.log("Story saved to IndexedDB"),t.next=70;break;case 67:t.prev=67,t.t0=t.catch(61),console.error("Error saving to IndexedDB:",t.t0);case 70:s.textContent="Cerita berhasil ditambahkan!",s.style.display="block",setTimeout((function(){window.location.hash="#/"}),2e3),t.next=77;break;case 75:throw console.error("Failed to add story:",L),new Error(L.message||"Gagal menambahkan cerita");case 77:t.next=83;break;case 79:t.prev=79,t.t1=t.catch(47),c.textContent=t.t1.message,c.style.display="block";case 83:return t.prev=83,a.style.display="inline",i.style.display="none",n.disabled=!1,t.finish(83);case 88:case"end":return t.stop()}}),t,null,[[47,79,83,88],[61,67]])})));return function(e){return t.apply(this,arguments)}}());case 18:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}],e&&xt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();const Lt={"/":new Q,"/login":new at,"/register":new pt,"/add-story":new Et};function St(t){return St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},St(t)}function jt(){jt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),c=new T(n||[]);return o(i,"_invoke",{value:j(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(I([])));k&&k!==r&&n.call(k,i)&&(w=k);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,i,c){var s=f(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==St(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function j(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=_(c,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(St(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new S(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),u(E,s,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function _t(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function Ot(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){_t(a,n,o,i,c,"next",t)}function c(t){_t(a,n,o,i,c,"throw",t)}i(void 0)}))}}function Pt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Tt(n.key),n)}}function Tt(t){var e=function(t){if("object"!=St(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=St(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==St(e)?e:e+""}function It(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function Nt(t,e){return t.get(Bt(t,e))}function At(t,e,r){return t.set(Bt(t,e),r),r}function Bt(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Gt=new WeakMap,Ft=new WeakMap,Dt=new WeakMap;const Ct=function(){return t=function t(e){var r=e.navigationDrawer,n=e.drawerButton,o=e.content;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),It(this,Gt,null),It(this,Ft,null),It(this,Dt,null),At(Gt,this,o),At(Ft,this,n),At(Dt,this,r),this._setupDrawer(),this._updateNavigation()},e=[{key:"_setupDrawer",value:function(){var t=this;Nt(Ft,this).addEventListener("click",(function(){var e=Nt(Dt,t).classList.toggle("open");Nt(Ft,t).setAttribute("aria-expanded",e)})),document.body.addEventListener("click",(function(e){Nt(Dt,t).contains(e.target)||Nt(Ft,t).contains(e.target)||(Nt(Dt,t).classList.remove("open"),Nt(Ft,t).setAttribute("aria-expanded","false")),Nt(Dt,t).querySelectorAll("a").forEach((function(r){r.contains(e.target)&&(Nt(Dt,t).classList.remove("open"),Nt(Ft,t).setAttribute("aria-expanded","false"))}))}));var e=document.getElementById("nav-logout");e&&e.addEventListener("click",(function(e){e.preventDefault(),localStorage.removeItem("authToken"),localStorage.removeItem("userName"),localStorage.removeItem("userEmail"),window.location.hash="#/login",t._updateNavigation()}))}},{key:"_updateNavigation",value:function(){var t=localStorage.getItem("authToken"),e=document.getElementById("nav-login"),r=document.getElementById("nav-register"),n=document.getElementById("nav-logout");t?(e&&(e.style.display="none"),r&&(r.style.display="none"),n&&(n.style.display="block")):(e&&(e.style.display="block"),r&&(r.style.display="block"),n&&(n.style.display="none"))}},{key:"renderPage",value:(r=Ot(jt().mark((function t(){var e,r=this;return jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=location.hash.replace("#","")||"/",i=void 0,i=a.split("/"),n={resource:i[1]||null,id:i[2]||null},o=void 0,o="",n.resource&&(o=o.concat("/".concat(n.resource))),n.id&&(o=o.concat("/:id")),e=Lt[o||"/"],this._updateNavigation(),!document.startViewTransition){t.next=7;break}document.startViewTransition(Ot(jt().mark((function t(){return jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.render();case 2:return Nt(Gt,r).innerHTML=t.sent,t.next=5,e.afterRender();case 5:case"end":return t.stop()}}),t)})))),t.next=13;break;case 7:return t.next=9,e.render();case 9:return Nt(Gt,this).innerHTML=t.sent,t.next=12,e.afterRender();case 12:this._animateTransition();case 13:case"end":return t.stop()}var n,o,a,i}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"_animateTransition",value:function(){var t=this;Nt(Gt,this).style.opacity="0",Nt(Gt,this).style.transform="translateY(10px)",Nt(Gt,this).offsetHeight,requestAnimationFrame((function(){Nt(Gt,t).style.transition="opacity 300ms ease-out, transform 300ms ease-out",Nt(Gt,t).style.opacity="1",Nt(Gt,t).style.transform="translateY(0)"}))}}],e&&Pt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Mt(t){return Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mt(t)}function qt(){qt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),c=new T(n||[]);return o(i,"_invoke",{value:j(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(I([])));k&&k!==r&&n.call(k,i)&&(w=k);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,i,c){var s=f(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Mt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function j(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=_(c,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Mt(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new S(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),u(E,s,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Rt(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function Wt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Rt(a,n,o,i,c,"next",t)}function c(t){Rt(a,n,o,i,c,"throw",t)}i(void 0)}))}}if("serviceWorker"in navigator){window.addEventListener("load",Wt(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.serviceWorker.register("/sw.js");case 3:return e=t.sent,console.log("Service Worker registered successfully:",e.scope),t.next=7,navigator.serviceWorker.ready;case 7:console.log("Service Worker ready!"),e.addEventListener("updatefound",(function(){var t=e.installing;t.addEventListener("statechange",(function(){"installed"===t.state&&navigator.serviceWorker.controller&&console.log("New service worker available")}))})),t.next=25;break;case 11:return t.prev=11,t.t0=t.catch(0),console.error("Service Worker registration failed:",t.t0),console.error("Error details:",t.t0.message),t.prev=15,t.next=18,navigator.serviceWorker.register("./sw.js");case 18:t.sent,console.log("Service Worker registered with alternative path"),t.next=25;break;case 22:t.prev=22,t.t1=t.catch(15),console.error("Alternative registration also failed:",t.t1);case 25:case"end":return t.stop()}}),t,null,[[0,11],[15,22]])}))));var Yt=!1;navigator.serviceWorker.addEventListener("controllerchange",(function(){Yt||(Yt=!0,window.location.reload())}))}document.addEventListener("DOMContentLoaded",Wt(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new Ct({content:document.querySelector("#main-content"),drawerButton:document.querySelector("#drawer-button"),navigationDrawer:document.querySelector("#navigation-drawer")}),t.next=3,e.renderPage();case 3:return t.next=5,W();case 5:window.addEventListener("hashchange",Wt(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.renderPage();case 2:case"end":return t.stop()}}),t)}))));case 6:case"end":return t.stop()}}),t)}))))})();