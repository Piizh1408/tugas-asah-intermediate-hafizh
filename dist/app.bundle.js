/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{"use strict";var t,e,r,n,o={},a={};function i(t){var e=a[t];if(void 0!==e)return e.exports;var r=a[t]={exports:{}};return o[t].call(r.exports,r,r.exports,i),r.exports}i.m=o,e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,i.t=function(r,n){if(1&n&&(r=this(r)),8&n)return r;if("object"==typeof r&&r){if(4&n&&r.__esModule)return r;if(16&n&&"function"==typeof r.then)return r}var o=Object.create(null);i.r(o);var a={};t=t||[null,e({}),e([]),e(e)];for(var s=2&n&&r;"object"==typeof s&&!~t.indexOf(s);s=e(s))Object.getOwnPropertyNames(s).forEach((t=>a[t]=()=>r[t]));return a.default=()=>r,i.d(o,a),o},i.d=(t,e)=>{for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},i.f={},i.e=t=>Promise.all(Object.keys(i.f).reduce(((e,r)=>(i.f[r](t,e),e)),[])),i.u=t=>t+".bundle.js",i.miniCssF=t=>{},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r={},n="app-starter-project-with-webpack:",i.l=(t,e,o,a)=>{if(r[t])r[t].push(e);else{var s,c;if(void 0!==o)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var f=u[l];if(f.getAttribute("src")==t||f.getAttribute("data-webpack")==n+o){s=f;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",n+o),s.src=t),r[t]=[e];var p=(e,n)=>{s.onerror=s.onload=null,clearTimeout(h);var o=r[t];if(delete r[t],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((t=>t(n))),e)return e(n)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),c&&document.head.appendChild(s)}},i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;i.g.importScripts&&(t=i.g.location+"");var e=i.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&(!t||!/^http(s?):/.test(t));)t=r[n--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t})(),(()=>{var t={524:0};i.f.j=(e,r)=>{var n=i.o(t,e)?t[e]:void 0;if(0!==n)if(n)r.push(n[2]);else{var o=new Promise(((r,o)=>n=t[e]=[r,o]));r.push(n[2]=o);var a=i.p+i.u(e),s=new Error;i.l(a,(r=>{if(i.o(t,e)&&(0!==(n=t[e])&&(t[e]=void 0),n)){var o=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;s.message="Loading chunk "+e+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,n[1](s)}}),"chunk-"+e,e)}};var e=(e,r)=>{var n,o,[a,s,c]=r,u=0;if(a.some((e=>0!==t[e]))){for(n in s)i.o(s,n)&&(i.m[n]=s[n]);c&&c(i)}for(e&&e(r);u<a.length;u++)o=a[u],i.o(t,o)&&t[o]&&t[o][0](),t[o]=0},r=self.webpackChunkapp_starter_project_with_webpack=self.webpackChunkapp_starter_project_with_webpack||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})();const s="https://story-api.dicoding.dev/v1",c="BLZByudG5fk3hHUc9s-BG_M6d_wD0VViLTrZB7s9hM0oTDSVqdgKr_8Ed130R0BRLkE-2dJ8A093y4zw_Y";function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function l(){l=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var a=e&&e.prototype instanceof b?e:b,i=Object.create(a.prototype),s=new A(n||[]);return o(i,"_invoke",{value:_(t,r,s)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",g={};function b(){}function w(){}function k(){}var x={};f(x,i,(function(){return this}));var E=Object.getPrototypeOf,L=E&&E(E(B([])));L&&L!==r&&n.call(L,i)&&(x=L);var S=k.prototype=b.prototype=Object.create(x);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(o,a,i,s){var c=h(t[o],t,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==u(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,i,s)}),(function(t){r("throw",t,i,s)})):e.resolve(f).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function _(e,r,n){var o=d;return function(a,i){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var c=I(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=h(e,r,n);if("normal"===u.type){if(o=n.done?m:y,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function I(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var a=h(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,g;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function B(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(u(e)+" is not iterable")}return w.prototype=k,o(S,"constructor",{value:k,configurable:!0}),o(k,"constructor",{value:w,configurable:!0}),w.displayName=f(k,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,k):(t.__proto__=k,f(t,c,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},j(P.prototype),f(P.prototype,s,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new P(p(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},j(S),f(S,c,"Generator"),f(S,i,(function(){return this})),f(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:B(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function f(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function p(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){f(a,n,o,i,s,"next",t)}function s(t){f(a,n,o,i,s,"throw",t)}i(void 0)}))}}var h={STORIES:"".concat(s,"/stories"),ADD_STORY:"".concat(s,"/stories")};function d(t){return y.apply(this,arguments)}function y(){return(y=p(l().mark((function t(e){var r;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(h.STORIES,{headers:{Authorization:"Bearer ".concat(e)}});case 2:return r=t.sent,t.next=5,r.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function v(t,e){return m.apply(this,arguments)}function m(){return(m=p(l().mark((function t(e,r){var n,o;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(h.ADD_STORY,{method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:e});case 3:return n=t.sent,console.log("Response status:",n.status),t.prev=5,t.next=8,n.json();case 8:o=t.sent,t.next=15;break;case 11:t.prev=11,t.t0=t.catch(5),console.error("Failed to parse JSON:",t.t0),o={error:!0,message:"Invalid response from server"};case 15:return n.ok||(o.error=!0,console.error("API Error Response:",o)),t.abrupt("return",o);case 19:return t.prev=19,t.t1=t.catch(0),console.error("Fetch error:",t.t1),t.abrupt("return",{error:!0,message:t.t1.message});case 23:case"end":return t.stop()}}),t,null,[[0,19],[5,11]])})))).apply(this,arguments)}function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function b(){b=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),s=new A(n||[]);return o(i,"_invoke",{value:_(t,r,s)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function w(){}function k(){}var x={};u(x,i,(function(){return this}));var E=Object.getPrototypeOf,L=E&&E(E(B([])));L&&L!==r&&n.call(L,i)&&(x=L);var S=k.prototype=m.prototype=Object.create(x);function j(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(o,a,i,s){var c=f(t[o],t,a);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==g(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,s)}),(function(t){r("throw",t,i,s)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function _(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var c=I(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function I(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function B(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(g(e)+" is not iterable")}return w.prototype=k,o(S,"constructor",{value:k,configurable:!0}),o(k,"constructor",{value:w,configurable:!0}),w.displayName=u(k,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,k):(t.__proto__=k,u(t,c,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},j(P.prototype),u(P.prototype,s,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new P(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},j(S),u(S,c,"Generator"),u(S,i,(function(){return this})),u(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:B(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function w(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function k(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){w(a,n,o,i,s,"next",t)}function s(t){w(a,n,o,i,s,"throw",t)}i(void 0)}))}}var x="bookmarks",E="stories";function L(){return new Promise((function(t,e){var r=indexedDB.open("StoryMapDB",3);r.onerror=function(){console.error("IndexedDB: Error opening database"),e(r.error)},r.onsuccess=function(){console.log("IndexedDB: Database opened successfully"),t(r.result)},r.onupgradeneeded=function(t){var e=t.target.result;if(!e.objectStoreNames.contains(x)){var r=e.createObjectStore(x,{keyPath:"storyId",autoIncrement:!1});r.createIndex("name","name",{unique:!1}),r.createIndex("bookmarkedAt","bookmarkedAt",{unique:!1}),console.log("IndexedDB: Bookmark store created")}if(!e.objectStoreNames.contains(E)){var n=e.createObjectStore(E,{keyPath:"id",autoIncrement:!1});n.createIndex("name","name",{unique:!1}),n.createIndex("createdAt","createdAt",{unique:!1}),console.log("IndexedDB: Stories store created")}}}))}function S(t){return j.apply(this,arguments)}function j(){return(j=k(b().mark((function t(e){var r,n,o,a,i;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,L();case 3:return r=t.sent,n=r.transaction([x],"readwrite"),o=n.objectStore(x),a={storyId:e.id,name:e.name,description:e.description,photoUrl:e.photoUrl,lat:e.lat,lon:e.lon,createdAt:e.createdAt||(new Date).toISOString(),bookmarkedAt:(new Date).toISOString()},i=o.put(a),t.abrupt("return",new Promise((function(t,r){i.onsuccess=function(){console.log("IndexedDB: Bookmark added",e.id),t(i.result)},i.onerror=function(){console.error("IndexedDB: Error adding bookmark",i.error),r(i.error)}})));case 11:throw t.prev=11,t.t0=t.catch(0),console.error("IndexedDB: Failed to add bookmark",t.t0),t.t0;case 15:case"end":return t.stop()}}),t,null,[[0,11]])})))).apply(this,arguments)}function P(){return _.apply(this,arguments)}function _(){return(_=k(b().mark((function t(){var e,r,n,o;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,L();case 3:return e=t.sent,r=e.transaction([x],"readonly"),n=r.objectStore(x),o=n.getAll(),t.abrupt("return",new Promise((function(t,e){o.onsuccess=function(){console.log("IndexedDB: Bookmarks retrieved",o.result.length),t(o.result)},o.onerror=function(){console.error("IndexedDB: Error reading bookmarks",o.error),e(o.error)}})));case 10:throw t.prev=10,t.t0=t.catch(0),console.error("IndexedDB: Failed to read bookmarks",t.t0),t.t0;case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function I(t){return O.apply(this,arguments)}function O(){return(O=k(b().mark((function t(e){var r,n,o,a;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,L();case 3:return r=t.sent,n=r.transaction([x],"readonly"),o=n.objectStore(x),a=o.get(e),t.abrupt("return",new Promise((function(t,e){a.onsuccess=function(){t(void 0!==a.result)},a.onerror=function(){console.error("IndexedDB: Error checking bookmark",a.error),e(a.error)}})));case 10:throw t.prev=10,t.t0=t.catch(0),console.error("IndexedDB: Failed to check bookmark",t.t0),t.t0;case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function T(t){return A.apply(this,arguments)}function A(){return(A=k(b().mark((function t(e){var r,n,o,a;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,L();case 3:return r=t.sent,n=r.transaction([x],"readwrite"),o=n.objectStore(x),a=o.delete(e),t.abrupt("return",new Promise((function(t,r){a.onsuccess=function(){console.log("IndexedDB: Bookmark removed",e),t(!0)},a.onerror=function(){console.error("IndexedDB: Error removing bookmark",a.error),r(a.error)}})));case 10:throw t.prev=10,t.t0=t.catch(0),console.error("IndexedDB: Failed to remove bookmark",t.t0),t.t0;case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function B(t){return N.apply(this,arguments)}function N(){return(N=k(b().mark((function t(e){var r,n,o,a,i;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,L();case 3:return r=t.sent,n=r.transaction([E],"readwrite"),o=n.objectStore(E),a={id:e.id,name:e.name,description:e.description,photoUrl:e.photoUrl,lat:e.lat,lon:e.lon,createdAt:e.createdAt||(new Date).toISOString(),savedAt:(new Date).toISOString()},i=o.put(a),t.abrupt("return",new Promise((function(t,r){i.onsuccess=function(){console.log("IndexedDB: Story saved",e.id),t(i.result)},i.onerror=function(){console.error("IndexedDB: Error saving story",i.error),r(i.error)}})));case 11:throw t.prev=11,t.t0=t.catch(0),console.error("IndexedDB: Failed to save story",t.t0),t.t0;case 15:case"end":return t.stop()}}),t,null,[[0,11]])})))).apply(this,arguments)}function D(){return G.apply(this,arguments)}function G(){return(G=k(b().mark((function t(){var e,r,n,o;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,L();case 3:return e=t.sent,r=e.transaction([E],"readonly"),n=r.objectStore(E),o=n.getAll(),t.abrupt("return",new Promise((function(t,e){o.onsuccess=function(){console.log("IndexedDB: Stories retrieved",o.result.length),t(o.result)},o.onerror=function(){console.error("IndexedDB: Error reading stories",o.error),e(o.error)}})));case 10:throw t.prev=10,t.t0=t.catch(0),console.error("IndexedDB: Failed to read stories",t.t0),t.t0;case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function C(t){return F.apply(this,arguments)}function F(){return(F=k(b().mark((function t(e){var r,n,o,a;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,L();case 3:return r=t.sent,n=r.transaction([E],"readwrite"),o=n.objectStore(E),a=o.delete(e),t.abrupt("return",new Promise((function(t,r){a.onsuccess=function(){console.log("IndexedDB: Story deleted",e),t(!0)},a.onerror=function(){console.error("IndexedDB: Error deleting story",a.error),r(a.error)}})));case 10:throw t.prev=10,t.t0=t.catch(0),console.error("IndexedDB: Failed to delete story",t.t0),t.t0;case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function M(t){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(t)}function W(){W=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),s=new O(n||[]);return o(i,"_invoke",{value:j(t,r,s)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(T([])));x&&x!==r&&n.call(x,i)&&(w=x);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,i,s){var c=f(t[o],t,a);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==M(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,s)}),(function(t){r("throw",t,i,s)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function j(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var c=P(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(M(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new S(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),u(E,c,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function q(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function U(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){q(a,n,o,i,s,"next",t)}function s(t){q(a,n,o,i,s,"throw",t)}i(void 0)}))}}function H(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(e),n=new Uint8Array(r.length),o=0;o<r.length;++o)n[o]=r.charCodeAt(o);return n}function R(){return c}function V(){var t=R();if(!t)return console.error("‚ùå VAPID key tidak ditemukan di config"),!1;if(t.length>150)return console.warn("‚ö†Ô∏è VAPID key terlalu panjang, kemungkinan masih placeholder"),console.warn("   Format VAPID key yang benar biasanya ~87 karakter (base64url)"),!1;if(!/^[A-Za-z0-9_-]+$/.test(t))return console.error("‚ùå Format VAPID key tidak valid (harus base64url: A-Z, a-z, 0-9, -, _)"),!1;try{var e=H(t);return 0===e.length||65!==e.length?(console.warn("‚ö†Ô∏è VAPID key length tidak sesuai (harus menghasilkan 65 bytes)"),!1):(console.log("‚úÖ VAPID key format valid"),console.log("   Key length: ".concat(t.length," karakter")),console.log("   Converted to: ".concat(e.length," bytes")),!0)}catch(t){return console.error("‚ùå Error converting VAPID key:",t.message),console.error("   Pastikan key adalah format base64url yang valid"),!1}}function Y(){return z.apply(this,arguments)}function z(){return(z=U(W().mark((function t(){var e,r,n,o,a,i,c,u,l,f,p,h,d,y;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("serviceWorker"in navigator){t.next=2;break}throw new Error("Service Worker tidak didukung di browser ini. Gunakan browser modern seperti Chrome, Firefox, atau Edge.");case 2:if("PushManager"in window){t.next=4;break}throw new Error("Push Notification tidak didukung di browser ini. Gunakan browser modern seperti Chrome, Firefox, atau Edge.");case 4:if("https:"===window.location.protocol||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname){t.next=6;break}throw new Error("Push Notification hanya bekerja di HTTPS atau localhost. Aplikasi harus di-deploy dengan HTTPS.");case 6:t.prev=6,e=null,r=1e4,n=Date.now();case 10:if(e||!(Date.now()-n<r)){t.next=25;break}return t.prev=11,t.next=14,navigator.serviceWorker.ready;case 14:if(!(e=t.sent)){t.next=17;break}return t.abrupt("break",25);case 17:t.next=23;break;case 19:return t.prev=19,t.t0=t.catch(11),t.next=23,new Promise((function(t){return setTimeout(t,500)}));case 23:t.next=10;break;case 25:if(e){t.next=27;break}throw new Error("Service Worker belum siap. Pastikan Service Worker sudah ter-register dengan benar. Refresh halaman dan coba lagi.");case 27:return console.log("‚úÖ Service Worker ready for push notification"),t.next=30,e.pushManager.getSubscription();case 30:if(!(o=t.sent)){t.next=34;break}return console.log("‚úÖ Already subscribed to push notifications"),t.abrupt("return",o);case 34:return console.log("üîî Requesting notification permission..."),t.next=37,Notification.requestPermission();case 37:if("denied"!==(a=t.sent)){t.next=40;break}throw new Error('Izin notifikasi ditolak. Untuk mengaktifkan notifikasi:\n1. Klik icon gembok/kunci di address bar\n2. Set "Notifications" ke "Allow"\n3. Refresh halaman dan coba lagi');case 40:if("default"!==a){t.next=42;break}throw new Error("Izin notifikasi belum diberikan. Silakan berikan izin notifikasi ketika diminta, kemudian coba lagi.");case 42:if("granted"===a){t.next=44;break}throw new Error("Izin notifikasi tidak diberikan. Status: "+a);case 44:if(console.log("‚úÖ Notification permission granted"),i=R()){t.next=48;break}throw new Error("VAPID public key tidak ditemukan di config");case 48:if(t.prev=48,65===H(i).length){t.next=52;break}throw new Error("VAPID key format tidak valid");case 52:t.next=57;break;case 54:throw t.prev=54,t.t1=t.catch(48),new Error("VAPID public key tidak valid. Pastikan VAPID key dari dokumentasi Story API sudah benar.");case 57:return console.log("‚úÖ VAPID key valid"),c=H(i),console.log("üì° Subscribing to push notifications..."),t.prev=60,t.next=63,e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:c});case 63:u=t.sent,console.log("‚úÖ Push subscription created in browser"),t.next=77;break;case 67:if(t.prev=67,t.t2=t.catch(60),console.error("‚ùå Error subscribing to push:",t.t2),"NotAllowedError"!==t.t2.name){t.next=74;break}throw new Error("Push subscription tidak diizinkan. Pastikan Service Worker sudah aktif dan browser mendukung push notification.");case 74:if(!t.t2.message||!t.t2.message.includes("VAPID")){t.next=76;break}throw new Error("VAPID key tidak valid. Pastikan menggunakan VAPID key yang benar dari dokumentasi Story API.");case 76:throw new Error("Gagal subscribe ke push notification: "+t.t2.message);case 77:if(l=localStorage.getItem("authToken")){t.next=81;break}return console.warn("No auth token found"),t.abrupt("return",null);case 81:return f=u.toJSON(),localStorage.setItem("pushSubscription",JSON.stringify(f)),console.log("‚úÖ Push subscription created in browser"),t.prev=84,t.next=87,fetch("".concat(s,"/notifications/subscribe"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(l)},body:JSON.stringify({endpoint:f.endpoint,keys:{p256dh:f.keys.p256dh,auth:f.keys.auth}})});case 87:if((p=t.sent).ok){t.next=97;break}return t.next=91,p.json().catch((function(){return{message:"Unknown error"}}));case 91:h=t.sent,d=h.message||"Server responded with status ".concat(p.status),console.warn("‚ö†Ô∏è Warning: Failed to send subscription to server:",d),console.warn("   Push notification masih bisa digunakan untuk testing via DevTools"),t.next=101;break;case 97:return t.next=99,p.json();case 99:y=t.sent,console.log("‚úÖ Push notification subscribed successfully to server:",y);case 101:t.next=108;break;case 103:t.prev=103,t.t3=t.catch(84),console.warn("‚ö†Ô∏è Warning: Error sending subscription to server:",t.t3.message),console.warn("   Push notification masih bisa digunakan untuk testing via DevTools"),console.warn("   Buka DevTools > Application > Service Workers > Push untuk test manual");case 108:return console.log("‚úÖ Push notification subscription ready"),t.abrupt("return",u);case 112:if(t.prev=112,t.t4=t.catch(6),console.error("‚ùå Error subscribing to push notifications:",t.t4),!t.t4.message){t.next=117;break}throw t.t4;case 117:throw new Error("Gagal mengaktifkan push notification: "+(t.t4.toString()||"Unknown error"));case 118:case"end":return t.stop()}}),t,null,[[6,112],[11,19],[48,54],[60,67],[84,103]])})))).apply(this,arguments)}function K(){return J.apply(this,arguments)}function J(){return(J=U(W().mark((function t(){var e,r,n,o,a,i;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.serviceWorker.ready;case 3:return e=t.sent,t.next=6,e.pushManager.getSubscription();case 6:if(!(r=t.sent)){t.next=32;break}if(n=r.toJSON(),!(o=localStorage.getItem("authToken"))||!n.endpoint){t.next=28;break}return t.prev=11,t.next=14,fetch("".concat(s,"/notifications/subscribe"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)},body:JSON.stringify({endpoint:n.endpoint})});case 14:if((a=t.sent).ok){t.next=19;break}console.warn("Failed to unsubscribe from server, but continuing with local unsubscribe"),t.next=23;break;case 19:return t.next=21,a.json();case 21:i=t.sent,console.log("‚úÖ Unsubscribed from server:",i);case 23:t.next=28;break;case 25:t.prev=25,t.t0=t.catch(11),console.warn("Could not send unsubscribe to server:",t.t0.message);case 28:return t.next=30,r.unsubscribe();case 30:localStorage.removeItem("pushSubscription"),console.log("‚úÖ Push notification unsubscribed successfully");case 32:t.next=38;break;case 34:throw t.prev=34,t.t1=t.catch(0),console.error("Error unsubscribing from push notifications:",t.t1),t.t1;case 38:case"end":return t.stop()}}),t,null,[[0,34],[11,25]])})))).apply(this,arguments)}function Z(){return $.apply(this,arguments)}function $(){return($=U(W().mark((function t(){var e,r;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.serviceWorker.ready;case 3:return e=t.sent,t.next=6,e.pushManager.getSubscription();case 6:return r=t.sent,t.abrupt("return",null!==r);case 10:return t.prev=10,t.t0=t.catch(0),console.error("Error checking subscription:",t.t0),t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function Q(){return X.apply(this,arguments)}function X(){return(X=U(W().mark((function t(){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("serviceWorker"in navigator&&"PushManager"in window){t.next=2;break}return t.abrupt("return");case 2:return V(),t.next=5,Z();case 5:if(t.sent){t.next=11;break}if(!localStorage.getItem("authToken")){t.next=11;break}return t.next=11,Y();case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function tt(t){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(t)}function et(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return rt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?rt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){s=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function rt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function nt(){nt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),s=new O(n||[]);return o(i,"_invoke",{value:j(t,r,s)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(T([])));x&&x!==r&&n.call(x,i)&&(w=x);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,i,s){var c=f(t[o],t,a);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==tt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,s)}),(function(t){r("throw",t,i,s)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function j(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var c=P(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(tt(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new S(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),u(E,c,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function ot(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function at(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){ot(a,n,o,i,s,"next",t)}function s(t){ot(a,n,o,i,s,"throw",t)}i(void 0)}))}}function it(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,st(n.key),n)}}function st(t){var e=function(t){if("object"!=tt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=tt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==tt(e)?e:e+""}var ct=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(c=at(nt().mark((function t(){return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="home-container">\n        <div class="hero-section">\n          <h1 class="hero-title">üìñ StoryMap</h1>\n          <p class="hero-subtitle">Temukan dan bagikan cerita perjalanan dari berbagai tempat</p>\n        </div>\n\n        <div class="map-controls">\n          <button id="filter-all" class="filter-btn active" aria-pressed="true">Semua</button>\n          <button id="filter-science" class="filter-btn" aria-pressed="false">Sains</button>\n          <button id="filter-history" class="filter-btn" aria-pressed="false">Sejarah</button>\n          <button id="filter-nature" class="filter-btn" aria-pressed="false">Alam</button>\n        </div>\n\n        <div class="content-grid">\n          <div class="map-container">\n            <div id="map" role="application" aria-label="Peta lokasi cerita"></div>\n          </div>\n\n          <div class="stories-sidebar">\n            <div class="stories-header">\n              <h2>Daftar Cerita</h2>\n              <div class="header-actions">\n                <a href="#/bookmark" class="btn btn-secondary" aria-label="Lihat bookmark">\n                  üîñ Bookmark Saya\n                </a>\n                <button id="push-notification-btn" class="btn btn-secondary" aria-label="Aktifkan notifikasi push">\n                  üîî Aktifkan Notifikasi\n                </button>\n                <button id="add-story-btn" class="btn btn-primary" aria-label="Tambah cerita baru">\n                  ‚ûï Tambah Cerita\n                </button>\n              </div>\n            </div>\n            <div id="stories-list" class="stories-list" role="list"></div>\n            <div id="stories-loading" class="loading-state" style="display: none;">\n              <p>Memuat cerita...</p>\n            </div>\n          </div>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return c.apply(this,arguments)})},{key:"afterRender",value:(s=at(nt().mark((function t(){var e,r,n,o,a,s=this;return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=localStorage.getItem("authToken")){t.next=4;break}return window.location.hash="#/login",t.abrupt("return");case 4:return t.next=6,i.e(481).then(i.t.bind(i,481,23));case 6:return r=t.sent,n=r.map("map").setView([-2.5,118],5),r.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"¬© OpenStreetMap contributors",maxZoom:19}).addTo(n),delete r.Icon.Default.prototype._getIconUrl,r.Icon.Default.mergeOptions({iconRetinaUrl:"images/marker-icon-2x.png",iconUrl:"images/marker-icon.png",shadowUrl:"images/marker-shadow.png"}),this.markers=[],this.allStories=[],this.currentFilter="all",this.map=n,this.L=r,document.getElementById("add-story-btn").addEventListener("click",(function(){window.location.hash="#/add-story"})),o=document.getElementById("push-notification-btn"),this._setupPushNotificationButtonWithRetry(o),(a=document.querySelectorAll(".filter-btn")).forEach((function(t){t.addEventListener("click",at(nt().mark((function e(){return nt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.forEach((function(t){t.classList.remove("active"),t.setAttribute("aria-pressed","false")})),t.classList.add("active"),t.setAttribute("aria-pressed","true"),s.currentFilter=t.id.replace("filter-",""),e.next=6,s._filterAndDisplayStories(s.allStories,s.currentFilter);case 6:case"end":return e.stop()}}),e)}))))})),t.next=24,this._loadStories(e);case 24:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"_loadStories",value:(a=at(nt().mark((function t(e){var r,n,o,a,i,s;return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=document.getElementById("stories-loading"),n=document.getElementById("stories-list"),r.style.display="block",n.innerHTML="",t.prev=4,t.next=7,d(e);case 7:if((o=t.sent).error||!o.listStory){t.next=36;break}this.allStories=o.listStory,t.prev=10,a=et(this.allStories),t.prev=12,s=nt().mark((function t(){var e;return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=i.value,t.next=3,B(e).catch((function(t){console.log("Story already in IndexedDB or error:",e.id)}));case 3:case"end":return t.stop()}}),t)})),a.s();case 15:if((i=a.n()).done){t.next=19;break}return t.delegateYield(s(),"t0",17);case 17:t.next=15;break;case 19:t.next=24;break;case 21:t.prev=21,t.t1=t.catch(12),a.e(t.t1);case 24:return t.prev=24,a.f(),t.finish(24);case 27:console.log("‚úÖ Data dari API berhasil disimpan ke IndexedDB"),t.next=33;break;case 30:t.prev=30,t.t2=t.catch(10),console.warn("Warning: Gagal menyimpan ke IndexedDB, tapi tetap lanjut:",t.t2);case 33:this._filterAndDisplayStories(this.allStories,"all"),t.next=37;break;case 36:n.innerHTML='<p class="empty-state">Tidak ada cerita tersedia.</p>';case 37:t.next=43;break;case 39:t.prev=39,t.t3=t.catch(4),console.error("Error loading stories from API:",t.t3),n.innerHTML='<p class="error-state">Gagal memuat cerita. Silakan coba lagi.</p>';case 43:return t.prev=43,r.style.display="none",t.finish(43);case 46:case"end":return t.stop()}}),t,this,[[4,39,43,46],[10,30],[12,21,24,27]])}))),function(t){return a.apply(this,arguments)})},{key:"_filterAndDisplayStories",value:(o=at(nt().mark((function t(e,r){var n,o,a,i,s=this;return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.markers.forEach((function(t){return s.map.removeLayer(t)})),this.markers=[],n=e,"all"!==r&&(n=e.filter((function(t){var e,n;return(null===(e=t.name)||void 0===e?void 0:e.toLowerCase().includes(r))||(null===(n=t.description)||void 0===n?void 0:n.toLowerCase().includes(r))}))),o=document.getElementById("stories-list"),0!==n.length){t.next=9;break}o.innerHTML='<p class="empty-state">Tidak ada cerita untuk filter ini</p>',t.next=21;break;case 9:return t.next=11,Promise.all(n.map((function(t){return I(t.id)})));case 11:a=t.sent,o.innerHTML=n.map((function(t,e){var r=a[e];return'\n        <article class="story-card" role="listitem" data-story-id="'.concat(t.id,'">\n          <div class="story-header">\n            <img \n              src="').concat(t.photoUrl,'" \n              alt="').concat(t.name||"Gambar cerita",'"\n              class="story-image"\n              loading="lazy"\n            >\n            <div class="story-title-section">\n              <h3 class="story-title">').concat(t.name||"Untitled",'</h3>\n              <p class="story-author">by ').concat(t.name||"Anonymous",'</p>\n            </div>\n          </div>\n          <p class="story-description">').concat(t.description||"No description available.",'</p>\n          <div class="story-footer">\n            <span class="story-location">üìç ').concat(t.lat,", ").concat(t.lon,'</span>\n            <time class="story-date" datetime="').concat(t.createdAt,'">\n              ').concat(s._formatDate(t.createdAt),'\n            </time>\n          </div>\n          <div class="story-actions">\n            <button \n              class="btn-bookmark ').concat(r?"bookmarked":"",'" \n              data-story-id="').concat(t.id,'"\n              aria-label="').concat(r?"Hapus bookmark":"Tambah bookmark"," ").concat(t.name||"ini",'"\n              title="').concat(r?"Hapus dari bookmark":"Tambah ke bookmark",'"\n            >\n              ').concat(r?"üîñ Hapus Bookmark":"üîñ Bookmark",'\n            </button>\n            <button \n              class="btn-save-story" \n              data-story-id="').concat(t.id,'"\n              aria-label="Simpan cerita ke IndexedDB ').concat(t.name||"ini",'"\n              title="Simpan cerita ke IndexedDB"\n            >\n              üíæ Simpan Cerita\n            </button>\n            <button \n              class="btn-delete-story" \n              data-story-id="').concat(t.id,'"\n              aria-label="Hapus cerita dari IndexedDB ').concat(t.name||"ini",'"\n              title="Hapus cerita dari IndexedDB"\n            >\n              üóëÔ∏è Hapus Cerita\n            </button>\n          </div>\n        </article>\n      ')})).join(""),document.querySelectorAll(".btn-bookmark").forEach((function(t){t.addEventListener("click",function(){var e=at(nt().mark((function e(r){var a,i,s,c;return nt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.target.getAttribute("data-story-id"),i=n.find((function(t){return t.id===a}))){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,I(a);case 7:if(!e.sent){e.next=23;break}return e.next=11,T(a);case 11:t.textContent="üîñ Bookmark",t.classList.remove("bookmarked"),t.setAttribute("aria-label","Tambah bookmark ".concat(i.name||"ini")),t.setAttribute("title","Tambah ke bookmark"),(s=document.createElement("div")).className="success-message",s.textContent="Bookmark dihapus",s.style.display="block",o.insertBefore(s,o.firstChild),setTimeout((function(){return s.remove()}),3e3),e.next=35;break;case 23:return e.next=25,S(i);case 25:t.textContent="üîñ Hapus Bookmark",t.classList.add("bookmarked"),t.setAttribute("aria-label","Hapus bookmark ".concat(i.name||"ini")),t.setAttribute("title","Hapus dari bookmark"),(c=document.createElement("div")).className="success-message",c.textContent="Bookmark ditambahkan",c.style.display="block",o.insertBefore(c,o.firstChild),setTimeout((function(){return c.remove()}),3e3);case 35:e.next=41;break;case 37:e.prev=37,e.t0=e.catch(4),console.error("Error toggling bookmark:",e.t0),alert("Gagal mengubah bookmark. Silakan coba lagi.");case 41:case"end":return e.stop()}}),e,null,[[4,37]])})));return function(t){return e.apply(this,arguments)}}())})),document.querySelectorAll(".btn-save-story").forEach((function(t){t.addEventListener("click",function(){var t=at(nt().mark((function t(e){var r,a,i;return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.target.getAttribute("data-story-id"),a=n.find((function(t){return t.id===r}))){t.next=4;break}return t.abrupt("return");case 4:return t.prev=4,t.next=7,B(a);case 7:(i=document.createElement("div")).className="success-message",i.textContent="Cerita berhasil disimpan ke IndexedDB",i.style.display="block",o.insertBefore(i,o.firstChild),setTimeout((function(){return i.remove()}),3e3),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(4),console.error("Error saving story:",t.t0),alert("Gagal menyimpan cerita. Silakan coba lagi.");case 19:case"end":return t.stop()}}),t,null,[[4,15]])})));return function(e){return t.apply(this,arguments)}}())})),document.querySelectorAll(".btn-delete-story").forEach((function(t){t.addEventListener("click",function(){var t=at(nt().mark((function t(e){var r,a,i;return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.target.getAttribute("data-story-id"),a=n.find((function(t){return t.id===r}))){t.next=4;break}return t.abrupt("return");case 4:if(!confirm('Apakah Anda yakin ingin menghapus cerita "'.concat(a.name||"ini",'" dari IndexedDB?'))){t.next=20;break}return t.prev=5,t.next=8,C(r);case 8:(i=document.createElement("div")).className="success-message",i.textContent="Cerita berhasil dihapus dari IndexedDB",i.style.display="block",o.insertBefore(i,o.firstChild),setTimeout((function(){return i.remove()}),3e3),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(5),console.error("Error deleting story:",t.t0),alert("Gagal menghapus cerita. Silakan coba lagi.");case 20:case"end":return t.stop()}}),t,null,[[5,16]])})));return function(e){return t.apply(this,arguments)}}())})),n.forEach((function(t){if(t.lat&&t.lon){var e=s.L.marker([t.lat,t.lon]).addTo(s.map).bindPopup('\n              <div class="marker-popup">\n                <h4>'.concat(t.name||"Untitled","</h4>\n                <p>").concat(t.description||"",'</p>\n                <img src="').concat(t.photoUrl,'" alt="').concat(t.name||"",'" style="max-width: 200px; margin-top: 10px;">\n              </div>\n            '));s.markers.push(e)}})),this.markers.length>0&&(i=new this.L.featureGroup(this.markers),this.map.fitBounds(i.getBounds().pad(.1)));case 21:case"end":return t.stop()}}),t,this)}))),function(t,e){return o.apply(this,arguments)})},{key:"_formatDate",value:function(t){return new Date(t).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"})}},{key:"_setupPushNotificationButtonWithRetry",value:(n=at(nt().mark((function t(e){var r;return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:e.textContent="üîî Memuat...",e.disabled=!0,r=0;case 5:if(!(r<10)){t.next=21;break}return t.next=8,new Promise((function(t){return setTimeout(t,1e3)}));case 8:return t.prev=8,t.next=11,this._setupPushNotificationButton(e);case 11:if(e.disabled&&!e.textContent.includes("Aktifkan")&&!e.textContent.includes("Matikan")){t.next=13;break}return t.abrupt("return");case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(8),console.error("Error setting up push notification button:",t.t0);case 18:r++,t.next=5;break;case 21:"file:"===window.location.protocol&&(e.disabled=!0,e.textContent="üîî Perlu HTTP Server",e.title="Aplikasi harus di-serve via http://localhost (npm run serve)");case 22:case"end":return t.stop()}}),t,this,[[8,15]])}))),function(t){return n.apply(this,arguments)})},{key:"_setupPushNotificationButton",value:(r=at(nt().mark((function t(e){var r,n,o,a,i,s,c;return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:if("serviceWorker"in navigator){t.next=7;break}return e.disabled=!0,e.textContent="üîî Notifikasi Tidak Didukung",e.title="Browser Anda tidak mendukung service worker",t.abrupt("return");case 7:if("PushManager"in window){t.next=12;break}return e.disabled=!0,e.textContent="üîî Notifikasi Tidak Didukung",e.title="Browser Anda tidak mendukung push notification",t.abrupt("return");case 12:if("https:"===window.location.protocol||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname){t.next=17;break}return e.disabled=!0,e.textContent="üîî Perlu HTTPS",e.title="Push notification hanya bekerja di HTTPS atau localhost",t.abrupt("return");case 17:return t.prev=17,console.log("‚è≥ Waiting for service worker to be ready..."),t.next=21,navigator.serviceWorker.getRegistrations();case 21:if(r=t.sent,console.log("üìã Service Worker registrations:",r.length),0!==r.length){t.next=28;break}return console.warn("‚ö†Ô∏è No service worker registered yet. Waiting for registration..."),e.textContent="üîî Menunggu Service Worker...",e.title="Service worker sedang didaftarkan, tunggu beberapa detik dan refresh halaman",t.abrupt("return");case 28:n=null,o=15e3,a=Date.now();case 31:if(n||!(Date.now()-a<o)){t.next=47;break}return t.prev=32,t.next=35,navigator.serviceWorker.ready;case 35:if(!(n=t.sent)){t.next=39;break}return console.log("‚úÖ Service Worker ready:",n.scope),t.abrupt("break",47);case 39:t.next=45;break;case 41:return t.prev=41,t.t0=t.catch(32),t.next=45,new Promise((function(t){return setTimeout(t,500)}));case 45:t.next=31;break;case 47:if(n){t.next=52;break}return console.error("‚ùå Service Worker tidak ready setelah menunggu"),e.textContent="üîî Service Worker Belum Siap",e.title="Service worker belum siap. Pastikan service worker sudah ter-register. Refresh halaman dan coba lagi.",t.abrupt("return");case 52:return console.log("‚úÖ Service Worker ready, checking subscription status..."),t.next=55,Z();case 55:i=t.sent,console.log("üìä Subscription status:",i),i?(e.textContent="üîî Matikan Notifikasi",e.classList.remove("btn-secondary"),e.classList.add("btn-success"),e.title="Notifikasi push aktif. Klik untuk menonaktifkan."):(e.textContent="üîî Aktifkan Notifikasi",e.classList.remove("btn-success"),e.classList.add("btn-secondary"),e.title="Klik untuk mengaktifkan notifikasi push"),t.next=65;break;case 60:t.prev=60,t.t1=t.catch(17),console.error("‚ùå Error setting up push notification button:",t.t1),e.textContent="üîî Error Setup",e.title="Terjadi error saat setup: "+t.t1.message+". Refresh halaman dan coba lagi.";case 65:c=(s=e).cloneNode(!0),s.parentNode.replaceChild(c,s),c.disabled=!1,c.addEventListener("click",function(){var t=at(nt().mark((function t(e){var r,n,o,a;return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),e.stopPropagation(),c.disabled=!0,c.textContent="üîî Memproses...",t.prev=4,t.next=7,Z();case 7:if(!t.sent){t.next=29;break}return t.prev=9,t.next=12,K();case 12:c.textContent="üîî Aktifkan Notifikasi",c.classList.remove("btn-success"),c.classList.add("btn-secondary"),(r=document.createElement("div")).className="success-message",r.textContent="Notifikasi push telah dinonaktifkan",r.style.display="block",document.getElementById("stories-list").insertBefore(r,document.getElementById("stories-list").firstChild),setTimeout((function(){return r.remove()}),3e3),t.next=27;break;case 23:t.prev=23,t.t0=t.catch(9),console.error("Error unsubscribing:",t.t0),alert("Gagal menonaktifkan notifikasi. Silakan coba lagi.");case 27:t.next=72;break;case 29:if(t.prev=29,!("serviceWorker"in navigator)){t.next=41;break}return t.prev=31,t.next=34,navigator.serviceWorker.ready;case 34:t.next=41;break;case 36:return t.prev=36,t.t1=t.catch(31),console.warn("Service worker belum ready, menunggu..."),t.next=41,new Promise((function(t,e){var r=setTimeout((function(){return e(new Error("Service Worker timeout"))}),5e3);navigator.serviceWorker.ready.then((function(){clearTimeout(r),t()})).catch(e)}));case 41:return t.next=43,Y();case 43:if(!t.sent){t.next=57;break}c.textContent="üîî Matikan Notifikasi",c.classList.remove("btn-secondary"),c.classList.add("btn-success"),(n=document.createElement("div")).className="success-message",n.textContent="‚úÖ Notifikasi push telah diaktifkan! Push notification siap digunakan.",n.style.display="block",(o=document.getElementById("stories-list"))&&(o.insertBefore(n,o.firstChild),setTimeout((function(){return n.remove()}),5e3)),console.log("‚úÖ Push notification activated successfully"),t.next=58;break;case 57:throw new Error("Subscription tidak berhasil dibuat. Periksa console untuk detail error.");case 58:t.next=72;break;case 60:t.prev=60,t.t2=t.catch(29),console.error("‚ùå Error subscribing to push notification:",t.t2),a="Gagal mengaktifkan notifikasi push.\n\n",t.t2.message?a+=t.t2.message:a+="Error: "+t.t2.toString(),a+="\n\nPenyebab umum:",a+="\n1. Service Worker belum ter-register",a+="\n2. Izin notifikasi ditolak",a+="\n3. Browser tidak mendukung push notification",a+="\n4. VAPID key tidak valid",a+="\n\nSilakan cek console untuk detail error.",alert(a);case 72:t.next=78;break;case 74:t.prev=74,t.t3=t.catch(4),console.error("Error toggling push notification:",t.t3),alert("Terjadi kesalahan saat mengatur notifikasi push: "+t.t3.message);case 78:return t.prev=78,c.disabled=!1,setTimeout(at(nt().mark((function t(){return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Z();case 3:t.sent?(c.textContent="üîî Matikan Notifikasi",c.classList.remove("btn-secondary"),c.classList.add("btn-success")):(c.textContent="üîî Aktifkan Notifikasi",c.classList.remove("btn-success"),c.classList.add("btn-secondary")),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Error updating button status:",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])}))),500),t.finish(78);case 82:case"end":return t.stop()}}),t,null,[[4,74,78,82],[9,23],[29,60],[31,36]])})));return function(e){return t.apply(this,arguments)}}());case 70:case"end":return t.stop()}}),t,null,[[17,60],[32,41]])}))),function(t){return r.apply(this,arguments)})}],e&&it(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,a,s,c}();function ut(t){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ut(t)}function lt(){lt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),s=new O(n||[]);return o(i,"_invoke",{value:j(t,r,s)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(T([])));x&&x!==r&&n.call(x,i)&&(w=x);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,i,s){var c=f(t[o],t,a);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==ut(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,s)}),(function(t){r("throw",t,i,s)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function j(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var c=P(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ut(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new S(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),u(E,c,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function ft(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function pt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){ft(a,n,o,i,s,"next",t)}function s(t){ft(a,n,o,i,s,"throw",t)}i(void 0)}))}}function ht(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dt(n.key),n)}}function dt(t){var e=function(t){if("object"!=ut(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ut(e)?e:e+""}var yt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(n=pt(lt().mark((function t(){return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="auth-container">\n        <div class="auth-card">\n          <h1 class="auth-title">Masuk ke StoryMap</h1>\n          <p class="auth-subtitle">Selamat datang kembali! Silakan masuk ke akun Anda.</p>\n          \n          <form id="login-form" class="auth-form" aria-label="Form login">\n            <div class="form-group">\n              <label for="login-email" class="form-label">Email</label>\n              <input \n                type="email" \n                id="login-email" \n                name="email" \n                class="form-input" \n                placeholder="nama@email.com"\n                required\n                aria-required="true"\n                aria-describedby="login-email-error"\n              >\n              <span id="login-email-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <div class="form-group">\n              <label for="login-password" class="form-label">Kata Sandi</label>\n              <input \n                type="password" \n                id="login-password" \n                name="password" \n                class="form-input" \n                placeholder="Masukkan kata sandi"\n                required\n                aria-required="true"\n                aria-describedby="login-password-error"\n              >\n              <span id="login-password-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <button type="submit" class="btn btn-primary btn-block">\n              <span class="btn-text">Masuk</span>\n              <span class="btn-loader" style="display: none;">‚è≥</span>\n            </button>\n\n            <div id="login-error" class="error-message" role="alert" aria-live="polite"></div>\n          </form>\n\n          <p class="auth-footer">\n            Belum punya akun? \n            <a href="#/register" class="auth-link">Daftar sekarang</a>\n          </p>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=pt(lt().mark((function t(){var e,r=this;return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(e=document.getElementById("login-form")).addEventListener("submit",function(){var t=pt(lt().mark((function t(n){var o,a,i,s,c,u,l,f,p,h;return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),o=e.querySelector('button[type="submit"]'),a=o.querySelector(".btn-text"),i=o.querySelector(".btn-loader"),s=document.getElementById("login-error"),c=document.getElementById("login-email"),u=document.getElementById("login-password"),s.textContent="",c.setAttribute("aria-invalid","false"),u.setAttribute("aria-invalid","false"),a.style.display="none",i.style.display="inline",o.disabled=!0,t.prev=13,l=new FormData(e),f={email:l.get("email"),password:l.get("password")},t.next=18,fetch("https://story-api.dicoding.dev/v1/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)});case 18:return p=t.sent,t.next=21,p.json();case 21:if(h=t.sent,p.ok){t.next=24;break}throw new Error(h.message||"Login gagal");case 24:localStorage.setItem("authToken",h.loginResult.token),localStorage.setItem("userName",h.loginResult.name),localStorage.setItem("userEmail",h.loginResult.email),window.location.hash="#/",r._animateTransition(),t.next=37;break;case 31:t.prev=31,t.t0=t.catch(13),s.textContent=t.t0.message,s.style.display="block",c.setAttribute("aria-invalid","true"),u.setAttribute("aria-invalid","true");case 37:return t.prev=37,a.style.display="inline",i.style.display="none",o.disabled=!1,t.finish(37);case 42:case"end":return t.stop()}}),t,null,[[13,31,37,42]])})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"_animateTransition",value:function(){var t=document.querySelector("#main-content");t.style.opacity="0",t.style.transform="translateY(20px)"}}],e&&ht(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function vt(t){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vt(t)}function mt(){mt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),s=new O(n||[]);return o(i,"_invoke",{value:j(t,r,s)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(T([])));x&&x!==r&&n.call(x,i)&&(w=x);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,i,s){var c=f(t[o],t,a);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==vt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,s)}),(function(t){r("throw",t,i,s)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function j(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var c=P(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(vt(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new S(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),u(E,c,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function gt(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function bt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){gt(a,n,o,i,s,"next",t)}function s(t){gt(a,n,o,i,s,"throw",t)}i(void 0)}))}}function wt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,kt(n.key),n)}}function kt(t){var e=function(t){if("object"!=vt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=vt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==vt(e)?e:e+""}var xt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(n=bt(mt().mark((function t(){return mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="auth-container">\n        <div class="auth-card">\n          <h1 class="auth-title">Daftar ke StoryMap</h1>\n          <p class="auth-subtitle">Bergabunglah untuk berbagi cerita perjalanan Anda.</p>\n          \n          <form id="register-form" class="auth-form" aria-label="Form pendaftaran">\n            <div class="form-group">\n              <label for="register-name" class="form-label">Nama</label>\n              <input \n                type="text" \n                id="register-name" \n                name="name" \n                class="form-input" \n                placeholder="Nama lengkap"\n                required\n                aria-required="true"\n                aria-describedby="register-name-error"\n              >\n              <span id="register-name-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <div class="form-group">\n              <label for="register-email" class="form-label">Email</label>\n              <input \n                type="email" \n                id="register-email" \n                name="email" \n                class="form-input" \n                placeholder="nama@email.com"\n                required\n                aria-required="true"\n                aria-describedby="register-email-error"\n              >\n              <span id="register-email-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <div class="form-group">\n              <label for="register-password" class="form-label">Kata Sandi</label>\n              <input \n                type="password" \n                id="register-password" \n                name="password" \n                class="form-input" \n                placeholder="Minimal 8 karakter"\n                required\n                minlength="8"\n                aria-required="true"\n                aria-describedby="register-password-error"\n              >\n              <span id="register-password-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <button type="submit" class="btn btn-primary btn-block">\n              <span class="btn-text">Daftar</span>\n              <span class="btn-loader" style="display: none;">‚è≥</span>\n            </button>\n\n            <div id="register-error" class="error-message" role="alert" aria-live="polite"></div>\n          </form>\n\n          <p class="auth-footer">\n            Sudah punya akun? \n            <a href="#/login" class="auth-link">Masuk sekarang</a>\n          </p>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=bt(mt().mark((function t(){var e;return mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(e=document.getElementById("register-form")).addEventListener("submit",function(){var t=bt(mt().mark((function t(r){var n,o,a,i,s,c,u,l,f,p,h;return mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),n=e.querySelector('button[type="submit"]'),o=n.querySelector(".btn-text"),a=n.querySelector(".btn-loader"),i=document.getElementById("register-error"),s=document.getElementById("register-name"),c=document.getElementById("register-email"),u=document.getElementById("register-password"),i.textContent="",s.setAttribute("aria-invalid","false"),c.setAttribute("aria-invalid","false"),u.setAttribute("aria-invalid","false"),!(u.value.length<8)){t.next=17;break}return i.textContent="Kata sandi harus minimal 8 karakter",i.style.display="block",u.setAttribute("aria-invalid","true"),t.abrupt("return");case 17:return o.style.display="none",a.style.display="inline",n.disabled=!0,t.prev=20,l=new FormData(e),f={name:l.get("name"),email:l.get("email"),password:l.get("password")},t.next=25,fetch("https://story-api.dicoding.dev/v1/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)});case 25:return p=t.sent,t.next=28,p.json();case 28:if(h=t.sent,p.ok){t.next=31;break}throw new Error(h.message||"Registrasi gagal");case 31:alert("Registrasi berhasil! Silakan login."),window.location.hash="#/login",t.next=40;break;case 35:t.prev=35,t.t0=t.catch(20),i.textContent=t.t0.message,i.style.display="block",c.setAttribute("aria-invalid","true");case 40:return t.prev=40,o.style.display="inline",a.style.display="none",n.disabled=!1,t.finish(40);case 45:case"end":return t.stop()}}),t,null,[[20,35,40,45]])})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}],e&&wt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Et(t){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Et(t)}function Lt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,s=[],c=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(s.push(n.value),s.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return s}}(t,e)||jt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function St(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=jt(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){s=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function jt(t,e){if(t){if("string"==typeof t)return Pt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pt(t,e):void 0}}function Pt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _t(){_t=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),s=new O(n||[]);return o(i,"_invoke",{value:j(t,r,s)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(T([])));x&&x!==r&&n.call(x,i)&&(w=x);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,i,s){var c=f(t[o],t,a);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==Et(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,s)}),(function(t){r("throw",t,i,s)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function j(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var c=P(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Et(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new S(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),u(E,c,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function It(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function Ot(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){It(a,n,o,i,s,"next",t)}function s(t){It(a,n,o,i,s,"throw",t)}i(void 0)}))}}function Tt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,At(n.key),n)}}function At(t){var e=function(t){if("object"!=Et(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Et(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Et(e)?e:e+""}var Bt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(n=Ot(_t().mark((function t(){return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="form-container">\n        <div class="form-card">\n          <h1 class="form-title">‚ûï Tambah Cerita Baru</h1>\n          <p class="form-subtitle">Bagikan pengalaman perjalanan Anda dengan yang lain</p>\n          \n          <form id="add-story-form" class="story-form" aria-label="Form tambah cerita">\n            <div class="form-group">\n              <label for="story-name" class="form-label">Judul Cerita</label>\n              <input \n                type="text" \n                id="story-name" \n                name="name" \n                class="form-input" \n                placeholder="Contoh: Eksplorasi Gunung Bromo"\n                required\n                aria-required="true"\n                aria-describedby="story-name-error story-name-help"\n              >\n              <small id="story-name-help" class="form-help">Berikan judul yang menarik untuk cerita Anda</small>\n              <span id="story-name-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <div class="form-group">\n              <label for="story-description" class="form-label">Deskripsi</label>\n              <textarea \n                id="story-description" \n                name="description" \n                class="form-textarea" \n                rows="5"\n                placeholder="Ceritakan pengalaman Anda di tempat ini..."\n                required\n                aria-required="true"\n                aria-describedby="story-description-error story-description-help"\n              ></textarea>\n              <small id="story-description-help" class="form-help">Minimal 10 karakter</small>\n              <span id="story-description-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <div class="form-group">\n              <label class="form-label">üìç Pilih Lokasi di Peta</label>\n              <div id="story-map" style="height: 350px; width: 100%; border-radius: 8px; margin-top: 10px; border: 2px solid #e5e7eb;"></div>\n              <small class="form-help">Klik pada peta untuk memilih koordinat Latitude dan Longitude</small>\n              <span id="story-map-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <div class="form-group">\n              <label for="story-lat" class="form-label">Latitude</label>\n              <input \n                type="number" \n                id="story-lat" \n                name="lat" \n                class="form-input" \n                step="any"\n                placeholder="-7.2575"\n                required\n                aria-required="true"\n                aria-describedby="story-lat-error story-lat-help"\n                readonly\n              >\n              <small id="story-lat-help" class="form-help">Koordinat akan terisi otomatis saat klik peta</small>\n              <span id="story-lat-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <div class="form-group">\n              <label for="story-lon" class="form-label">Longitude</label>\n              <input \n                type="number" \n                id="story-lon" \n                name="lon" \n                class="form-input" \n                step="any"\n                placeholder="112.7521"\n                required\n                aria-required="true"\n                aria-describedby="story-lon-error story-lon-help"\n                readonly\n              >\n              <small id="story-lon-help" class="form-help">Koordinat akan terisi otomatis saat klik peta</small>\n              <span id="story-lon-error" class="error-message" role="alert" aria-live="polite"></span>\n            </div>\n\n            <div class="form-group">\n              <label for="story-photo" class="form-label">Foto</label>\n              <input \n                type="file" \n                id="story-photo" \n                name="photo" \n                class="form-file" \n                accept="image/*"\n                required\n                aria-required="true"\n                aria-describedby="story-photo-error story-photo-help"\n              >\n              <small id="story-photo-help" class="form-help">Format: JPG, PNG, atau GIF (max 2MB)</small>\n              <span id="story-photo-error" class="error-message" role="alert" aria-live="polite"></span>\n              <div id="photo-preview" class="photo-preview"></div>\n            </div>\n\n            <div class="form-actions">\n              <a href="#/" class="btn btn-secondary">Batal</a>\n              <button type="submit" class="btn btn-primary">\n                <span class="btn-text">Simpan Cerita</span>\n                <span class="btn-loader" style="display: none;">‚è≥</span>\n              </button>\n            </div>\n\n            <div id="form-error" class="error-message" role="alert" aria-live="polite"></div>\n            <div id="form-success" class="success-message" role="status" aria-live="polite"></div>\n          </form>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=Ot(_t().mark((function t(){var e,r,n,o,a,s,c;return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.getElementById("add-story-form"),r=document.getElementById("story-photo"),n=document.getElementById("photo-preview"),o=localStorage.getItem("authToken")){t.next=7;break}return window.location.hash="#/login",t.abrupt("return");case 7:return t.next=9,i.e(481).then(i.t.bind(i,481,23));case 9:a=t.sent,s=a.default.map("story-map").setView([-7.2575,112.7521],13),a.default.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"¬© OpenStreetMap contributors",maxZoom:19}).addTo(s),delete a.default.Icon.Default.prototype._getIconUrl,a.default.Icon.Default.mergeOptions({iconRetinaUrl:"images/marker-icon-2x.png",iconUrl:"images/marker-icon.png",shadowUrl:"images/marker-shadow.png"}),c=null,s.on("click",(function(t){var e=t.latlng,r=e.lat,n=e.lng,o=document.getElementById("story-lat"),i=document.getElementById("story-lon"),u=document.getElementById("story-map-error");o.value=r.toFixed(4),i.value=n.toFixed(4),u.textContent="",u.style.display="none",o.setAttribute("aria-invalid","false"),i.setAttribute("aria-invalid","false"),c&&s.removeLayer(c),c=a.default.marker([r,n]).addTo(s).bindPopup("Koordinat yang dipilih:<br>Lat: ".concat(r.toFixed(4),", Lon: ").concat(n.toFixed(4))).openPopup()})),r.addEventListener("change",(function(t){var e=t.target.files[0];if(e){if(e.size>2097152)return document.getElementById("story-photo-error").textContent="Ukuran file maksimal 2MB",r.setAttribute("aria-invalid","true"),void(n.innerHTML="");if(!e.type.startsWith("image/"))return document.getElementById("story-photo-error").textContent="File harus berupa gambar",r.setAttribute("aria-invalid","true"),void(n.innerHTML="");document.getElementById("story-photo-error").textContent="",r.setAttribute("aria-invalid","false");var o=new FileReader;o.onload=function(t){n.innerHTML='\n            <img src="'.concat(t.target.result,'" alt="Preview foto" class="preview-image">\n          ')},o.readAsDataURL(e)}})),e.addEventListener("submit",function(){var t=Ot(_t().mark((function t(r){var n,a,i,s,c,u,l,f,p,h,d,y,m,g,b,w,k,x,E;return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),n=e.querySelector('button[type="submit"]'),a=n.querySelector(".btn-text"),i=n.querySelector(".btn-loader"),s=document.getElementById("form-error"),c=document.getElementById("form-success"),u=document.getElementById("story-map-error"),s.textContent="",c.textContent="",s.style.display="none",c.style.display="none",l=document.getElementById("story-description"),!((f=l.value.length)<10)){t.next=18;break}return s.textContent="Deskripsi harus minimal 10 karakter",s.style.display="block",l.setAttribute("aria-invalid","true"),t.abrupt("return");case 18:if(!(f>1e3)){t.next=23;break}return s.textContent="Deskripsi maksimal 1000 karakter",s.style.display="block",l.setAttribute("aria-invalid","true"),t.abrupt("return");case 23:if(p=document.getElementById("story-lat"),h=document.getElementById("story-lon"),d=parseFloat(p.value),y=parseFloat(h.value),""!==p.value&&""!==h.value&&!isNaN(d)&&!isNaN(y)){t.next=34;break}return u.textContent="‚ö†Ô∏è Silakan pilih lokasi di peta dengan mengklik pada peta",u.style.display="block",p.setAttribute("aria-invalid","true"),h.setAttribute("aria-invalid","true"),document.getElementById("story-map").scrollIntoView({behavior:"smooth",block:"center"}),t.abrupt("return");case 34:if(!(d<-90||d>90)){t.next=39;break}return s.textContent="Latitude harus antara -90 dan 90",s.style.display="block",p.setAttribute("aria-invalid","true"),t.abrupt("return");case 39:if(!(y<-180||y>180)){t.next=44;break}return s.textContent="Longitude harus antara -180 dan 180",s.style.display="block",h.setAttribute("aria-invalid","true"),t.abrupt("return");case 44:a.style.display="none",i.style.display="inline",n.disabled=!0,t.prev=47,(m=new FormData(e)).delete("name"),m.set("lat",d.toString()),m.set("lon",y.toString()),console.log("FormData contents:"),g=St(m.entries());try{for(g.s();!(b=g.n()).done;)w=Lt(b.value,2),k=w[0],x=w[1],console.log(k,":",x)}catch(t){g.e(t)}finally{g.f()}return t.next=57,v(m,o);case 57:if((E=t.sent).error){t.next=64;break}c.textContent="Cerita berhasil ditambahkan!",c.style.display="block",setTimeout((function(){window.location.hash="#/"}),2e3),t.next=66;break;case 64:throw console.error("Failed to add story:",E),new Error(E.message||"Gagal menambahkan cerita");case 66:t.next=72;break;case 68:t.prev=68,t.t0=t.catch(47),s.textContent=t.t0.message,s.style.display="block";case 72:return t.prev=72,a.style.display="inline",i.style.display="none",n.disabled=!1,t.finish(72);case 77:case"end":return t.stop()}}),t,null,[[47,68,72,77]])})));return function(e){return t.apply(this,arguments)}}());case 18:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}],e&&Tt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Nt(t){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nt(t)}function Dt(){Dt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),s=new O(n||[]);return o(i,"_invoke",{value:j(t,r,s)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(T([])));x&&x!==r&&n.call(x,i)&&(w=x);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,i,s){var c=f(t[o],t,a);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==Nt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,s)}),(function(t){r("throw",t,i,s)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function j(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var c=P(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Nt(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new S(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),u(E,c,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Gt(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function Ct(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Gt(a,n,o,i,s,"next",t)}function s(t){Gt(a,n,o,i,s,"throw",t)}i(void 0)}))}}function Ft(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Mt(n.key),n)}}function Mt(t){var e=function(t){if("object"!=Nt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Nt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Nt(e)?e:e+""}var Wt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(a=Ct(Dt().mark((function t(){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="home-container">\n        <div class="hero-section">\n          <h1 class="hero-title">üîñ Bookmark Saya</h1>\n          <p class="hero-subtitle">Cerita yang telah Anda simpan</p>\n        </div>\n\n        <div class="content-grid">\n          <div class="map-container">\n            <div id="bookmark-map" role="application" aria-label="Peta lokasi cerita bookmark"></div>\n          </div>\n\n          <div class="stories-sidebar">\n            <div class="stories-header">\n              <h2>Daftar Bookmark</h2>\n              <div class="header-actions">\n                <button id="show-bookmarks-btn" class="btn btn-secondary active">üîñ Bookmark</button>\n                <button id="show-stories-btn" class="btn btn-secondary">üíæ Cerita Tersimpan</button>\n              </div>\n            </div>\n            <div id="bookmarks-list" class="stories-list" role="list"></div>\n            <div id="stories-list" class="stories-list" role="list" style="display: none;"></div>\n            <div id="bookmarks-loading" class="loading-state" style="display: none;">\n              <p>Memuat bookmark...</p>\n            </div>\n            <div id="stories-loading" class="loading-state" style="display: none;">\n              <p>Memuat cerita tersimpan...</p>\n            </div>\n            <div id="bookmarks-empty" class="empty-state" style="display: none;">\n              <p>Belum ada bookmark. Bookmark cerita favorit Anda dari halaman beranda!</p>\n            </div>\n            <div id="stories-empty" class="empty-state" style="display: none;">\n              <p>Belum ada cerita tersimpan. Simpan cerita dari halaman beranda!</p>\n            </div>\n          </div>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})},{key:"afterRender",value:(o=Ct(Dt().mark((function t(){var e,r,n,o,a=this;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(localStorage.getItem("authToken")){t.next=4;break}return window.location.hash="#/login",t.abrupt("return");case 4:return t.next=6,i.e(481).then(i.t.bind(i,481,23));case 6:return e=t.sent,r=e.map("bookmark-map").setView([-2.5,118],5),e.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"¬© OpenStreetMap contributors",maxZoom:19}).addTo(r),delete e.Icon.Default.prototype._getIconUrl,e.Icon.Default.mergeOptions({iconRetinaUrl:"images/marker-icon-2x.png",iconUrl:"images/marker-icon.png",shadowUrl:"images/marker-shadow.png"}),this.markers=[],this.bookmarks=[],this.stories=[],this.map=r,this.L=e,this.currentView="bookmarks",n=document.getElementById("show-bookmarks-btn"),o=document.getElementById("show-stories-btn"),n.addEventListener("click",(function(){a.currentView="bookmarks",n.classList.add("active"),o.classList.remove("active"),document.getElementById("bookmarks-list").style.display="block",document.getElementById("stories-list").style.display="none",a._loadBookmarks()})),o.addEventListener("click",(function(){a.currentView="stories",o.classList.add("active"),n.classList.remove("active"),document.getElementById("bookmarks-list").style.display="none",document.getElementById("stories-list").style.display="block",a._loadStories()})),t.next=23,this._loadBookmarks();case 23:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"_loadBookmarks",value:(n=Ct(Dt().mark((function t(){var e,r,n,o;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=document.getElementById("bookmarks-loading"),r=document.getElementById("bookmarks-list"),n=document.getElementById("bookmarks-empty"),e.style.display="block",r.innerHTML="",n.style.display="none",t.prev=6,t.next=9,P();case 9:(o=t.sent)&&o.length>0?(this.bookmarks=o,this._displayBookmarks(o),n.style.display="none"):(r.innerHTML="",n.style.display="block"),t.next=18;break;case 13:t.prev=13,t.t0=t.catch(6),console.error("Error loading bookmarks:",t.t0),r.innerHTML='<p class="error-state">Gagal memuat bookmark. Silakan coba lagi.</p>',n.style.display="none";case 18:return t.prev=18,e.style.display="none",t.finish(18);case 21:case"end":return t.stop()}}),t,this,[[6,13,18,21]])}))),function(){return n.apply(this,arguments)})},{key:"_displayBookmarks",value:function(t){var e=this,r=document.getElementById("bookmarks-list");if(this.markers.forEach((function(t){return e.map.removeLayer(t)})),this.markers=[],0!==t.length){if(r.innerHTML=t.map((function(t){return'\n      <article class="story-card" role="listitem" data-story-id="'.concat(t.storyId,'">\n        <div class="story-header">\n          <img \n            src="').concat(t.photoUrl,'" \n            alt="').concat(t.name||"Gambar cerita",'"\n            class="story-image"\n            loading="lazy"\n          >\n          <div class="story-title-section">\n            <h3 class="story-title">').concat(t.name||"Untitled",'</h3>\n            <p class="story-author">by ').concat(t.name||"Anonymous",'</p>\n          </div>\n        </div>\n        <p class="story-description">').concat(t.description||"No description available.",'</p>\n        <div class="story-footer">\n          <span class="story-location">üìç ').concat(t.lat,", ").concat(t.lon,'</span>\n          <time class="story-date" datetime="').concat(t.createdAt,'">\n            ').concat(e._formatDate(t.createdAt),'\n          </time>\n        </div>\n        <div class="story-actions">\n          <button \n            class="btn-remove-bookmark" \n            data-story-id="').concat(t.storyId,'"\n            aria-label="Hapus bookmark ').concat(t.name||"ini",'"\n            title="Hapus dari bookmark"\n          >\n            üóëÔ∏è Hapus Bookmark\n          </button>\n        </div>\n      </article>\n    ')})).join(""),document.querySelectorAll(".btn-remove-bookmark").forEach((function(t){t.addEventListener("click",function(){var t=Ct(Dt().mark((function t(n){var o,a;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(o=n.target.getAttribute("data-story-id"))||!confirm("Apakah Anda yakin ingin menghapus bookmark ini?")){t.next=19;break}return t.prev=2,t.next=5,T(o);case 5:return t.next=7,e._loadBookmarks();case 7:(a=document.createElement("div")).className="success-message",a.textContent="Bookmark berhasil dihapus",a.style.display="block",r.insertBefore(a,r.firstChild),setTimeout((function(){a.remove()}),3e3),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(2),console.error("Error removing bookmark:",t.t0),alert("Gagal menghapus bookmark. Silakan coba lagi.");case 19:case"end":return t.stop()}}),t,null,[[2,15]])})));return function(e){return t.apply(this,arguments)}}())})),t.forEach((function(t){if(t.lat&&t.lon){var r=e.L.marker([t.lat,t.lon]).addTo(e.map).bindPopup('\n            <div class="marker-popup">\n              <h4>'.concat(t.name||"Untitled","</h4>\n              <p>").concat(t.description||"",'</p>\n              <img src="').concat(t.photoUrl,'" alt="').concat(t.name||"",'" style="max-width: 200px; margin-top: 10px;">\n            </div>\n          '));e.markers.push(r)}})),this.markers.length>0){var n=new this.L.featureGroup(this.markers);this.map.fitBounds(n.getBounds().pad(.1))}}else r.innerHTML='<p class="empty-state">Tidak ada bookmark</p>'}},{key:"_loadStories",value:(r=Ct(Dt().mark((function t(){var e,r,n,o;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=document.getElementById("stories-loading"),r=document.getElementById("stories-list"),n=document.getElementById("stories-empty"),e.style.display="block",r.innerHTML="",n.style.display="none",t.prev=6,t.next=9,D();case 9:(o=t.sent)&&o.length>0?(this.stories=o,this._displayStories(o),n.style.display="none"):(r.innerHTML="",n.style.display="block"),t.next=18;break;case 13:t.prev=13,t.t0=t.catch(6),console.error("Error loading stories:",t.t0),r.innerHTML='<p class="error-state">Gagal memuat cerita tersimpan. Silakan coba lagi.</p>',n.style.display="none";case 18:return t.prev=18,e.style.display="none",t.finish(18);case 21:case"end":return t.stop()}}),t,this,[[6,13,18,21]])}))),function(){return r.apply(this,arguments)})},{key:"_displayStories",value:function(t){var e=this,r=document.getElementById("stories-list");if(this.markers.forEach((function(t){return e.map.removeLayer(t)})),this.markers=[],0!==t.length){if(r.innerHTML=t.map((function(t){return'\n      <article class="story-card" role="listitem" data-story-id="'.concat(t.id,'">\n        <div class="story-header">\n          <img \n            src="').concat(t.photoUrl,'" \n            alt="').concat(t.name||"Gambar cerita",'"\n            class="story-image"\n            loading="lazy"\n          >\n          <div class="story-title-section">\n            <h3 class="story-title">').concat(t.name||"Untitled",'</h3>\n            <p class="story-author">by ').concat(t.name||"Anonymous",'</p>\n          </div>\n        </div>\n        <p class="story-description">').concat(t.description||"No description available.",'</p>\n        <div class="story-footer">\n          <span class="story-location">üìç ').concat(t.lat,", ").concat(t.lon,'</span>\n          <time class="story-date" datetime="').concat(t.createdAt,'">\n            ').concat(e._formatDate(t.createdAt),'\n          </time>\n        </div>\n        <div class="story-actions">\n          <button \n            class="btn-delete-story" \n            data-story-id="').concat(t.id,'"\n            aria-label="Hapus cerita ').concat(t.name||"ini",' dari IndexedDB"\n            title="Hapus cerita dari IndexedDB"\n          >\n            üóëÔ∏è Hapus Cerita\n          </button>\n        </div>\n      </article>\n    ')})).join(""),document.querySelectorAll(".btn-delete-story").forEach((function(n){n.addEventListener("click",function(){var n=Ct(Dt().mark((function n(o){var a,i,s;return Dt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=o.target.getAttribute("data-story-id"),i=t.find((function(t){return t.id===a})),!a||!confirm('Apakah Anda yakin ingin menghapus cerita "'.concat((null==i?void 0:i.name)||"ini",'" dari IndexedDB?'))){n.next=20;break}return n.prev=3,n.next=6,C(a);case 6:return n.next=8,e._loadStories();case 8:(s=document.createElement("div")).className="success-message",s.textContent="Cerita berhasil dihapus dari IndexedDB",s.style.display="block",r.insertBefore(s,r.firstChild),setTimeout((function(){s.remove()}),3e3),n.next=20;break;case 16:n.prev=16,n.t0=n.catch(3),console.error("Error deleting story:",n.t0),alert("Gagal menghapus cerita. Silakan coba lagi.");case 20:case"end":return n.stop()}}),n,null,[[3,16]])})));return function(t){return n.apply(this,arguments)}}())})),t.forEach((function(t){if(t.lat&&t.lon){var r=e.L.marker([t.lat,t.lon]).addTo(e.map).bindPopup('\n            <div class="marker-popup">\n              <h4>'.concat(t.name||"Untitled","</h4>\n              <p>").concat(t.description||"",'</p>\n              <img src="').concat(t.photoUrl,'" alt="').concat(t.name||"",'" style="max-width: 200px; margin-top: 10px;">\n            </div>\n          '));e.markers.push(r)}})),this.markers.length>0){var n=new this.L.featureGroup(this.markers);this.map.fitBounds(n.getBounds().pad(.1))}}else r.innerHTML='<p class="empty-state">Tidak ada cerita tersimpan</p>'}},{key:"_formatDate",value:function(t){return new Date(t).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"})}}],e&&Ft(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,a}();const qt={"/":new ct,"/login":new yt,"/register":new xt,"/add-story":new Bt,"/bookmark":new Wt};function Ut(t){return Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ut(t)}function Ht(){Ht=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),s=new O(n||[]);return o(i,"_invoke",{value:j(t,r,s)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(T([])));x&&x!==r&&n.call(x,i)&&(w=x);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,i,s){var c=f(t[o],t,a);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==Ut(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,s)}),(function(t){r("throw",t,i,s)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function j(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var c=P(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ut(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new S(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),u(E,c,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Rt(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function Vt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Rt(a,n,o,i,s,"next",t)}function s(t){Rt(a,n,o,i,s,"throw",t)}i(void 0)}))}}function Yt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zt(n.key),n)}}function zt(t){var e=function(t){if("object"!=Ut(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ut(e)?e:e+""}function Kt(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function Jt(t,e){return t.get($t(t,e))}function Zt(t,e,r){return t.set($t(t,e),r),r}function $t(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Qt=new WeakMap,Xt=new WeakMap,te=new WeakMap;const ee=function(){return t=function t(e){var r=e.navigationDrawer,n=e.drawerButton,o=e.content;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Kt(this,Qt,null),Kt(this,Xt,null),Kt(this,te,null),Zt(Qt,this,o),Zt(Xt,this,n),Zt(te,this,r),this._setupDrawer(),this._updateNavigation()},e=[{key:"_setupDrawer",value:function(){var t=this;Jt(Xt,this).addEventListener("click",(function(){var e=Jt(te,t).classList.toggle("open");Jt(Xt,t).setAttribute("aria-expanded",e)})),document.body.addEventListener("click",(function(e){Jt(te,t).contains(e.target)||Jt(Xt,t).contains(e.target)||(Jt(te,t).classList.remove("open"),Jt(Xt,t).setAttribute("aria-expanded","false")),Jt(te,t).querySelectorAll("a").forEach((function(r){r.contains(e.target)&&(Jt(te,t).classList.remove("open"),Jt(Xt,t).setAttribute("aria-expanded","false"))}))}));var e=document.getElementById("nav-logout");e&&e.addEventListener("click",(function(e){e.preventDefault(),localStorage.removeItem("authToken"),localStorage.removeItem("userName"),localStorage.removeItem("userEmail"),window.location.hash="#/login",t._updateNavigation()}))}},{key:"_updateNavigation",value:function(){var t=localStorage.getItem("authToken"),e=document.getElementById("nav-login"),r=document.getElementById("nav-register"),n=document.getElementById("nav-logout"),o=document.getElementById("nav-bookmark");t?(e&&(e.style.display="none"),r&&(r.style.display="none"),n&&(n.style.display="block"),o&&(o.style.display="block")):(e&&(e.style.display="block"),r&&(r.style.display="block"),n&&(n.style.display="none"),o&&(o.style.display="none"))}},{key:"renderPage",value:(r=Vt(Ht().mark((function t(){var e,r=this;return Ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=location.hash.replace("#","")||"/",i=void 0,i=a.split("/"),n={resource:i[1]||null,id:i[2]||null},o=void 0,o="",n.resource&&(o=o.concat("/".concat(n.resource))),n.id&&(o=o.concat("/:id")),e=qt[o||"/"],this._updateNavigation(),!document.startViewTransition){t.next=7;break}document.startViewTransition(Vt(Ht().mark((function t(){return Ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.render();case 2:return Jt(Qt,r).innerHTML=t.sent,t.next=5,e.afterRender();case 5:case"end":return t.stop()}}),t)})))),t.next=13;break;case 7:return t.next=9,e.render();case 9:return Jt(Qt,this).innerHTML=t.sent,t.next=12,e.afterRender();case 12:this._animateTransition();case 13:case"end":return t.stop()}var n,o,a,i}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"_animateTransition",value:function(){var t=this;Jt(Qt,this).style.opacity="0",Jt(Qt,this).style.transform="translateY(10px)",Jt(Qt,this).offsetHeight,requestAnimationFrame((function(){Jt(Qt,t).style.transition="opacity 300ms ease-out, transform 300ms ease-out",Jt(Qt,t).style.opacity="1",Jt(Qt,t).style.transform="translateY(0)"}))}}],e&&Yt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function re(t){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},re(t)}function ne(){ne=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),s=new O(n||[]);return o(i,"_invoke",{value:j(t,r,s)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(T([])));x&&x!==r&&n.call(x,i)&&(w=x);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,i,s){var c=f(t[o],t,a);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==re(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,s)}),(function(t){r("throw",t,i,s)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function j(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var c=P(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(re(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new S(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(E),u(E,c,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function oe(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return ae(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ae(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){s=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function ae(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ie(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function se(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){ie(a,n,o,i,s,"next",t)}function s(t){ie(a,n,o,i,s,"throw",t)}i(void 0)}))}}if("serviceWorker"in navigator){window.addEventListener("load",se(ne().mark((function t(){var e,r,n,o,a,i,s,c,u,l;return ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.prev=1,t.next=4,navigator.serviceWorker.getRegistrations();case 4:e=t.sent,r=oe(e),t.prev=6,r.s();case 8:if((n=r.n()).done){t.next=16;break}if((o=n.value).scope!==window.location.origin+"/"){t.next=14;break}return console.log("üóëÔ∏è Unregistering old service worker with root scope:",o.scope),t.next=14,o.unregister();case 14:t.next=8;break;case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(6),r.e(t.t0);case 21:return t.prev=21,r.f(),t.finish(21);case 24:t.next=29;break;case 26:t.prev=26,t.t1=t.catch(1),console.warn("Warning: Could not unregister old service workers:",t.t1);case 29:return a=function(){var t=window.location.pathname;if(console.log("üìç Current pathname:",t),console.log("üìç Current href:",window.location.href),"/"===t)return console.log("üìç Detected root path"),"/";if(t.endsWith("/"))return console.log("üìç Detected base path with trailing slash:",t),t;if(t.includes("/index.html")){var e=t.substring(0,t.indexOf("/index.html")+1);return console.log("üìç Detected base path from index.html:",e),e}var r=t.lastIndexOf("/");if(r>0){var n=t.substring(0,r+1);return console.log("üìç Detected base path from last slash:",n),n}var o=t.split("/").filter((function(t){return t}));if(o.length>0){var a="/"+o.join("/")+"/";return console.log("üìç Detected base path from segments:",a),a}return console.log("üìç Using root as fallback"),"/"}(),i=a.endsWith("/")?a:a+"/",s=i.startsWith("/")?i:"/"+i,c=s+"sw.js",u=s,console.log("üìÅ Final base path:",s),console.log("üìÅ Service Worker path:",c),console.log("üìÅ Service Worker scope:",u),console.log("üìÅ Full URL:",window.location.href),t.next=41,navigator.serviceWorker.register(c,{scope:u});case 41:return l=t.sent,console.log("‚úÖ Service Worker registered successfully!"),console.log("‚úÖ Registration scope:",l.scope),console.log("‚úÖ Registration active:",l.active),console.log("‚úÖ Registration installing:",l.installing),console.log("‚úÖ Registration waiting:",l.waiting),t.next=49,navigator.serviceWorker.ready;case 49:console.log("‚úÖ Service Worker ready!"),l.addEventListener("updatefound",(function(){var t=l.installing;console.log("üîÑ New service worker found, state:",t.state),t.addEventListener("statechange",(function(){console.log("üîÑ Service worker state changed to:",t.state),"installed"===t.state&&navigator.serviceWorker.controller&&console.log("‚úÖ New service worker installed and active")}))})),t.next=61;break;case 53:t.prev=53,t.t2=t.catch(0),console.error("‚ùå Service Worker registration failed:",t.t2),console.error("‚ùå Error name:",t.t2.name),console.error("‚ùå Error message:",t.t2.message),console.error("‚ùå Error stack:",t.t2.stack),console.error("‚ùå Current location:",window.location.href),console.error("‚ùå Current pathname:",window.location.pathname);case 61:case"end":return t.stop()}}),t,null,[[0,53],[1,26],[6,18,21,24]])}))));var ce=!1;navigator.serviceWorker.addEventListener("controllerchange",(function(){ce||(ce=!0,window.location.reload())}))}document.addEventListener("DOMContentLoaded",se(ne().mark((function t(){var e;return ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new ee({content:document.querySelector("#main-content"),drawerButton:document.querySelector("#drawer-button"),navigationDrawer:document.querySelector("#navigation-drawer")}),t.next=3,e.renderPage();case 3:return t.next=5,Q();case 5:window.addEventListener("hashchange",se(ne().mark((function t(){return ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.renderPage();case 2:case"end":return t.stop()}}),t)}))));case 6:case"end":return t.stop()}}),t)}))))})();